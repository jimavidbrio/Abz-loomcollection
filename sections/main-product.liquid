{%- liquid
  assign zoom_size = 'master'
  assign min_aspect_ratio = 0.6

  assign current_variant = product.selected_or_first_available_variant
  assign featured_media = product.selected_or_first_available_variant.featured_media | default: product.featured_media

  for block in section.blocks
    if block.type == 'variant_picker' and block.settings.select_first_variant == false
      assign current_variant = product.selected_variant | default: false
      assign featured_media = product.featured_media
    endif
  endfor

  assign product_form_id = 'product-form-' | append: section.id | append: '-' | append: product.id
  assign product_form_installments_id = product_form_id | append: '-installments'

  assign show_preorder_label = false
  if settings.prod_pre_order_label_show and product.template_suffix contains 'preorder'
    assign show_preorder_label = true
  endif

  if section.settings.enable_var_img_grouping
    assign variant_image_grouping_option_index = ''
    assign grouping_options = section.settings.var_img_grouping_option | downcase | replace: ', ', ',' | split: ','
    for option in product.options
      assign option_downcase = option | downcase
      if grouping_options contains option_downcase
        assign variant_image_grouping_option_index = forloop.index0
        break
      endif
    endfor
  endif
-%}

<div class="main-pdp-detail" data-section-type="main-product" data-components="accordion,custom-select,modal">
  {% if section.settings.show_breadcrumbs %}
    <div class="container desktop-only not-in-quickbuy" data-cc-animate data-cc-animate-delay="0.2s">
      <div class="page-header">
        {% render 'breadcrumbs', show_next_prev: true %}
      </div>
    </div>
  {% endif %}

  <div class="product-detail quickbuy-content spaced-row container{% if current_variant.compare_at_price > current_variant.price %} variant-status--on-sale{% endif %}{% if current_variant.available == false %} variant-status--unavailable{% endif %}">
    <div class="gallery gallery--layout-{{ section.settings.gallery_layout }} gallery-size-{{ section.settings.gallery_size }} product-column-left {% if product.media.size > 1 %}has-thumbnails{% endif %}"
      data-cc-animate
      data-cc-animate-delay="0.2s"
      data-variant-image-grouping="{{ section.settings.enable_var_img_grouping }}"
      data-variant-image-grouping-option="{{ section.settings.var_img_grouping_option | escape }}"
      data-variant-image-grouping-option-index="{{ variant_image_grouping_option_index }}">
      <div class="gallery__inner{% if section.settings.enable_sticky_columns %} sticky-content-container{% endif %}">
          <div class="main-image">
            {%- liquid
              assign initial_slide = 0

              if product.media.size > 0
                for media in product.media
                  if media.id == featured_media.id
                    assign initial_slide = forloop.index0
                    break
                  endif
                endfor
              endif
            -%}

            <div class="slideshow product-slideshow slideshow--custom-initial" 
                data-slick='{"adaptiveHeight":true,"initialSlide":{{ initial_slide }}}'>

              {%- if product.media.size > 0 -%}

                {%- for media in product.media -%}
                  <div class="slide{% if forloop.index0 == initial_slide %} slide--custom-initial{% endif %}" 
                      data-media-id="{{ media.id }}">

                    {%- if media.media_type == 'image' and section.settings.enable_zoom -%}
                      <a class="show-gallery" href="{{ media.preview_image | img_url: zoom_size }}">
                    {%- endif -%}

                      {%- render 'media', media: media, min_aspect_ratio: min_aspect_ratio -%}

                    {%- if media.media_type == 'image' and section.settings.enable_zoom -%}
                      </a>
                    {%- endif -%}

                  </div>
                {%- endfor -%}

              {%- else -%}

                <div class="slide slide--custom-initial">
                  <img src="{{ 'no-img.jpg' | asset_url }}" alt="No Image Available" />
                </div>

              {%- endif -%}

            </div>

            <div class="slideshow-controls">
              <div class="slideshow-controls__arrows"></div>
            </div>

            {%- assign models = product.media | where: 'media_type', 'model' -%}
            {% if models.size > 0 %}
              <script type="application/json" class="model-json">
                {{- product.media | where: 'media_type', 'model' | json -}}
              </script>
              <button
                class="view-in-space"
                data-shopify-xr
                data-shopify-model3d-id="{{ models.first.id }}"
                data-shopify-title="{{ product.title | escape }}"
                data-shopify-xr-hidden>
                {%- render 'icon-3d-badge-full-color' -%}
                <span class="view-in-space__text">{{ 'products.product.view_in_space' | t }}</span>
              </button>
            {% endif %}

            {% render 'product-label-detail', product: product, current_variant: current_variant %}
          </div>

        {% if product.media.size > 1 %}
          <div class="thumbnails{% unless section.settings.gallery_layout contains 'carousel' %} mobile-only{% endunless %}">
            {% for media in product.media %}
              <a class="thumbnail thumbnail--media-{{ media.media_type }}" href="{% if section.settings.enable_zoom %}{{ media.preview_image | img_url: zoom_size }}{% else %}#{% endif %}" data-media-id="{{ media.id }}">
                {% render 'responsive-image', image: media.preview_image, min_aspect_ratio: min_aspect_ratio %}

                {%- if media.media_type == 'video' or media.media_type =='external_video' -%}
                  <div class="thumbnail__badge">
                    {% render 'icon-video-badge-full-color' %}
                  </div>
                {%- endif -%}
                {%- if media.media_type == 'model' -%}
                  <div class="thumbnail__badge">
                    {% render 'icon-3d-badge-full-color' %}
                  </div>
                {%- endif -%}
              </a>
            {% endfor %}
          </div>
        {% endif %}
      </div>
    </div>

    <div class="detail product-column-right" data-cc-animate data-cc-animate-delay="0.2s">
      <div class="product-form{% if section.settings.enable_sticky_columns %} sticky-content-container{% endif %}" data-ajax-add-to-cart="true" data-product-id="{{ product.id }}" data-enable-history-state="true">
        {%- assign product_form_present = false -%}
        {%- capture original_select -%}
          <select name="id" class="original-selector{% if product.variants.size == 1 %} hidden{% endif %}" aria-label="{{ 'products.product.selector_label' | t | escape }}">
            {% if product.variants.size > 1 %}<option value="">{{ 'products.product.no_selection' | t }}</option>{% endif %}
            {% for variant in product.variants %}
            <option value="{{ variant.id }}"
              {% if variant == current_variant %} selected="selected"{% endif %}
              {% if section.settings.inventory_transfers_enable and variant.incoming %}
                {%- if variant.next_incoming_date -%}
                  {%- assign date = variant.next_incoming_date | date: format: 'date' -%}
                  {%- if variant.available -%}
                    data-inventory-transfer="{{ 'products.transfers.will_not_ship_until' | t: date: date | escape }}"
                  {%- else -%}
                    data-inventory-transfer="{{ 'products.transfers.will_be_in_stock_after' | t: date: date | escape }}"
                  {%- endif -%}
                {%- else -%}
                  data-inventory-transfer="{{ 'products.transfers.waiting_for_stock' | t | escape }}"
                {%- endif -%}
              {% endif %}
              data-stock="{% if variant.inventory_management != blank and variant.inventory_quantity <= 0 %}out{% endif %}">{{ variant.title | escape }}</option>
            {% endfor %}
          </select>
        {%- endcapture -%}

        {% for block in section.blocks %}
          {% case block.type %}
            {% when '@app' %}
              <div class="{% unless settings.qb_show_app_blocks %}not-in-quickbuy{% endunless %}">
                {% render block %}
              </div>

            {% when 'title' %}
              <div class="title-row" {{ block.shopify_attributes }}>
                <h3 class="title">{{ product.title | escape }}</h3>
              </div>

        {% render 'judgeme_widgets', widget_type: 'judgeme_preview_badge', jm_style: '', concierge_install: true, product: product %}
        
            {% when 'price' %}
              <div class="price-container" {{ block.shopify_attributes }}>
                <div class="variant-visibility-area">
                  {%- for variant in product.variants -%}
                    <script type="text/template" data-variant-id="{{ variant.id }}">
                      {%- capture price_html -%}
                        <div class="price-area">
                          <div class="price h4-style {% if variant.compare_at_price > variant.price %}on-sale{% endif %}">
                            <span 
                              data-wpd-product-handle="{{ product.handle }}"
                              data-wpd-variant-id="{{ variant.id }}"
                              data-wpd-variant-price="{{ variant.price }}"
                              data-wpd-variant-compare-at-price="{{ variant.compare_at_price }}"
                              data-wpd-product-collection-ids="{% assign wpdProductCollectionIds = product.collections | map:'id' %}{{ wpdProductCollectionIds | join:',' }}"
                              data-wpd-product-id="{{ product.id }}"
                              class="current-price theme-money">
                              {%- if settings.product_currency_code_enabled -%}
                                {{- variant.price | money_with_currency -}}
                              {%- else -%}
                                {{- variant.price | money -}}
                              {%- endif -%}
                            </span>
                        
                            {% if variant.compare_at_price > variant.price %}
                            <span class="data-wpd-hide was-price theme-money">{{ variant.compare_at_price | money_with_currency }}</span>
                            {% endif %}
                          </div>

                          {% render 'unit-price', variant: variant %}
                        </div>
                      {%- endcapture -%}
                      {{- price_html -}}
                    </script>
                    {%- if current_variant and current_variant.id == variant.id -%}{{ price_html }}{%- endif -%}
                  {%- endfor -%}

                  <script type="text/template" data-variant-id="">
                    {%- capture price_html -%}
                      <div class="price-area">
                        {%- assign cheapest_variant = product.variants | sort: 'price' | first -%}
                        <div class="price h4-style {% if cheapest_variant.compare_at_price > cheapest_variant.price %}on-sale{% endif %}">
                          {% if product.price_varies %}
                            <span class="data-wpd-hide price__from">{{ 'products.listing.from' | t }}</span>
                          {% endif %}
                        
                          <span 
                            data-wpd-product-handle="{{ product.handle }}"
                            data-wpd-variant-id="{{ product.selected_or_first_available_variant.id }}"
                            data-wpd-variant-price="{{ product.selected_or_first_available_variant.price }}"
                            data-wpd-variant-compare-at-price="{{ product.selected_or_first_available_variant.compare_at_price }}"
                            data-wpd-product-collection-ids="{% assign wpdProductCollectionIds = product.collections | map:'id' %}{{ wpdProductCollectionIds | join:',' }}"
                            data-wpd-product-id="{{ product.id }}"
                            class="current-price theme-money">
                            {%- if settings.product_currency_code_enabled -%}
                              {{ cheapest_variant.price | money_with_currency }}
                            {%- else -%}
                              {{ cheapest_variant.price | money }}
                            {%- endif -%}
                          </span>
                          {% if cheapest_variant.compare_at_price > cheapest_variant.price %}
                            <span class="data-wpd-hide was-price theme-money">{{ cheapest_variant.compare_at_price | money }}</span>
                          {% endif %}

                          {% render 'unit-price', variant: cheapest_variant %}
                        </div>
                      </div>
                    {%- endcapture -%}
                    {{- price_html -}}
                  </script>

                  {% if current_variant == false %}
                    {{- price_html -}}
                  {% endif %}
                </div>

                <div class="price-descriptors">
                  {%- form 'product', product, id: product_form_installments_id -%}
                    <input type="hidden" name="id" value="{% if current_variant %}{{ current_variant.id }}{% endif %}">
                    {{ form | payment_terms }}
                  {%- endform -%}

                  {%- if block.settings.show_tax_and_shipping -%}
                    {%- if cart.taxes_included or shop.shipping_policy.body != blank -%}
                      <div class="product-policies">
                        {%- if cart.taxes_included -%}
                          {{ 'products.product.include_taxes' | t }}
                        {%- endif -%}
                        {%- if shop.shipping_policy.body != blank -%}
                          {{ 'products.product.shipping_policy_html' | t: link: shop.shipping_policy.url }}
                        {%- endif -%}
                      </div>
                    {%- endif -%}
                  {%- endif -%}

                  {% if section.settings.inventory_transfers_enable %}
                    <div class="product-inventory-transfer {% unless current_variant.incoming %}product-inventory-transfer--none{% endunless %}">
                      {%- if current_variant.incoming -%}
                        {%- if current_variant.next_incoming_date -%}
                          {%- assign date = current_variant.next_incoming_date | date: format: 'date' -%}
                          {%- if current_variant.available -%}
                            {{ 'products.transfers.will_not_ship_until' | t: date: date }}
                          {%- else -%}
                            {{ 'products.transfers.will_be_in_stock_after' | t: date: date }}
                          {%- endif -%}
                        {%- else -%}
                          {{ 'products.transfers.waiting_for_stock' | t }}
                        {%- endif -%}
                      {%- endif -%}
                    </div>
                  {% endif %}
                </div>
                {%- if block.settings.enable_product_reviews_by_price and product.metafields.reviews.rating_count != blank -%}
                  {%- assign rating_count = product.metafields.reviews.rating_count | plus: 0 -%}
                  {%- if rating_count > 0 -%}
                    <div class="theme-product-reviews">
                      <a href="{{ product.url }}#shopify-product-reviews">
                        {% render 'rating', rating_value: product.metafields.reviews.rating.value %}
                        <span class="cc-rating-custom-caption">
                          {{ rating_count }} {{ 'products.product.reviews_link' | t: count: rating_count | downcase }}
                        </span>
                      </a>
                    </div>
                  {%- endif -%}
                {%- endif -%}
              </div>

<div class="postpay-widget"
       data-type="product"
       style="font-size:.95em;"
       data-amount="{{ product.price }}"
       data-currency="{{ shop.currency }}">
</div>

            {% when 'description' %}
              <div class="{% unless block.settings.show_in_quickbuy %}not-in-quickbuy{% endunless %}{% if block.settings.show_in_tab %} product-detail-accordion{% endif %}" {{ block.shopify_attributes }}>
                {% if block.settings.show_in_tab %}
                  {%- capture accordion_title -%}
                    {%- if block.settings.icon == blank -%}
                      {{- 'products.product.description' | t -}}
                    {%- else -%}
                      <div class="with-icon">
                        {% render 'icon', icon: block.settings.icon, size: 'small' %}
                        <span class="with-icon__beside">{{ 'products.product.description' | t }}</span>
                      </div>
                    {%- endif -%}
                  {%- endcapture -%}
                  {% render 'accordion', allow_multi_open: true, add_content_class: 'rte cf', first_item_open: block.settings.open_tab, item1_title: accordion_title, item1_content: product.description %}
                {% else %}
                  <div class="product-description rte cf">
                    {%- if block.settings.icon == blank -%}
                      {{- product.description -}}
                    {%- else -%}
                      <div class="with-icon">
                        {% render 'icon', icon: block.settings.icon, size: 'small' %}
                        <span class="with-icon__beside">{{ product.description }}</span>
                      </div>
                    {%- endif -%}
                  </div>
                {% endif %}
              </div>

            {% when 'vendor' %}
              {%- liquid
                assign product_vendor_handle = product.vendor | handle
                if collections[product_vendor_handle].handle == product_vendor_handle
                  assign vendor_url = collections[product_vendor_handle].url
                else
                  assign vendor_url = product.vendor | url_for_vendor
                endif
              -%}
              <div class="vendor lightly-spaced-row" {{ block.shopify_attributes }}>
                <span class="product-detail-label">{{ 'products.product.vendor' | t }}</span> {{ product.vendor | link_to: vendor_url, class: 'underline' }}
              </div>

            {% when 'sku' %}
              <div class="sku {% if current_variant and current_variant.sku == blank %}sku--no-sku{% endif %}" {{ block.shopify_attributes }}>
                <span class="product-detail-label">{{ 'products.product.sku' | t }}</span> <span class="sku__value">{% if current_variant %}{{ current_variant.sku }}{% endif %}</span>
              </div>

            {% when 'variant_picker' %}
              {% if product.metafields.custom.swatches %}
                <div class="input-row customSwatches" {{ block.shopify_attributes }}>
                  <div class="option-selectors" data-disable-unavailable="true">
                    <fieldset class="option-selector-fieldset">
                      <div class="opposing-items">
                        <legend class="label">Color <span class="label__value">{% if product.metafields.custom.color_name %}{{ product.metafields.custom.color_name }}{% else %}{{ product.title }}{% endif %}</span></legend>
                      </div>
                      <div class="option-selector__btns">
                        <style>
                            [data-swatch="colors-{{ product.id }}"] { --aspect-ratio: 1.9266666666666667 }
                            {% if product.metafields.custom.swatch_image != blank %}
                              [data-swatch="colors-{{ product.id }}"] { 
                              background-image: url({{ product.metafields.custom.swatch_image.value | img_url: '50x' }});
                              background-size: cover;
                              background-position: center;
                              }
                            {% elsif product.metafields.custom.color %}
                              [data-swatch="colors-{{ product.id }}"] {
                                background-color: {{product.metafields.custom.color}};
                              }
                            {% else %}
                              [data-swatch="colors-{{ product.id }}"] { --swatch-background-image: url({{ product.metafields.custom.image }}) }
                            {% endif %}
                        </style>
                        <a href="{{ product.url }}" data-color-name="{{ product.metafields.custom.color_name }}">
                          <label class="opt-label round-box" data-swatch="colors-{{ product.id }}" style="border: 2px solid #000;">
                            <span class="opt-label__text" style="opacity: 0;">{{ product.metafields.custom.color }}</span>
                          </label>
                        </a>
                <style>
                  .customSwatches .round-box{
                    border-radius: 50%;
                    width: 30px;
                    height: 30px;
                    min-width: 30px;
                    padding: 0;
                    min-height: 30px;
                  }
                </style>
                        {% for swatch in product.metafields.custom.swatches.value %}
                          <style>
                            [data-swatch="colors-{{ swatch.id }}"] { --aspect-ratio: 1.9266666666666667 }
                          {% if swatch.metafields.custom.swatch_image != blank %}
                              [data-swatch="colors-{{ swatch.id }}"] { 
                                background-image: url({{ swatch.metafields.custom.swatch_image.value | img_url: '50x' }});
                                background-size: cover;
                                background-position: center;
                              }
                            {% elsif swatch.metafields.custom.color %}
                              [data-swatch="colors-{{ swatch.id }}"] {
                                background-color: {{swatch.metafields.custom.color}};
                              }
                            {% else %}
                              [data-swatch="colors-{{ swatch.id }}"] { --swatch-background-image: url({{ swatch.metafields.custom.image | img_url: '50x' }}) }
                            {% endif %}
                            
                            </style>
                          <a href="{{ swatch.url }}" data-color-name="{{ swatch.metafields.custom.color_name }}">
                            <label class="opt-label round-box" data-swatch="colors-{{ swatch.id }}">
                              <span class="opt-label__text" style="opacity: 0;">{{ swatch.metafields.custom.color }}</span>
                            </label>
                          </a>
                        {% endfor %}
                      </div>
                    </fieldset>
                  </div>
                </div>
              {% endif %}
              <div class="input-row" {{ block.shopify_attributes }}>
                {% render 'variant-picker', section: section, product: product, block: block %}
              </div>

            {% when 'buy_buttons' %}
              {% capture upsells_html %}
                {% if product.metafields.custom.upsells_note.value %}
                  <span class="pdp-upsells-note">{{ product.metafields.custom.upsells_note.value }}</span>
                {% endif %}


                {% if product.metafields.custom.upsell_products_2.value != blank %}
                  <div class="upsell-row">
                    <div class="add-light-title label">
                      {{ product.metafields.custom.upsell_products_2_label.value | default: 'Goes well with' }}
                    </div>
                    <div class="upsell-select upsell2-select">
                      <div id="current-option-2" class="current-option option-value upsell2" data-value="">
                        <div class="current-option-img-wrapper">
                          <img
                            class="upsell-img current-option-img upsell2"
                            src="path_to_default_image.jpg"
                            alt="Default Option Image"
                          >
                        </div>
                        <div id="upsell-detail-2">UpsellProduct 2</div>
                      </div>
                      <div class="upsell-dropdown">
                        <ul id="add-light-2" class="add-item">
                          {% for listproduct in product.metafields.custom.upsell_products_2.value %}
                            {% assign variant = listproduct.selected_or_first_available_variant %}
                            {% if variant.available %}
                              <li
                                class="option_value upsell2"
                                data-value="yes"
                                data-ajax-add-to-cart="true"
                                data-item-id="{{ listproduct.selected_or_first_available_variant.id }}"
                                data-item-price="{{ listproduct.selected_or_first_available_variant.price }}"
                                data-bulb-qty="{{ product.metafields.custom.upsell_products_2_quantity.value }}"
                                data-add-to-cart-text="Add to Cart"
                              >
                                <div class="upsell-img">
                                  <img src="{{ listproduct.featured_image | img_url:'100x' }}">
                                </div>
                                {% assign upsell_quantity_2 = product.metafields.custom.upsell_products_2_quantity.value
                                  | default: 1
                                %}
                                {% assign total_price_2 = listproduct.selected_or_first_available_variant.price
                                  | times: upsell_quantity_2
                                %}
                                <div class="product_title">
                                  Yes. {{ listproduct.title }} (+{{ total_price_2 | money_with_currency }})
                                </div>
                              </li>
                            {% endif %}
                          {% endfor %}
                          <li class="option_value upsell2" data-value="no">
                            <div class="upsell-img none-img">
                              <img class="no-image" src="{{'no-img.png'| asset_url }} ">
                            </div>
                            <div>No</div>
                          </li>
                        </ul>
                      </div>
                    </div>
                  </div>
                {% endif %}
              
                {% if product.metafields.custom.upsell_products.value != blank %}
                  <div class="upsell-row">
                    <div class="add-light-title label">
                      {{
                        product.metafields.custom.upsell_products_label.value
                        | default: 'Include Complementaries?'
                      }}
                    </div>
                    <div class="upsell-select upsell1-select">
                      <div id="current-option-1" class="current-option option-value upsell1" data-value="">
                        <div class="current-option-img-wrapper">
                          <img
                            class="upsell-img current-option-img upsell1"
                            src="path_to_default_image.jpg"
                            alt="Default Option Image"
                          >
                        </div>
                        <div id="upsell-detail-1">UpsellProduct</div>
                      </div>
                      <div class="upsell-dropdown">
                        <ul id="add-light-1" class="add-item">
                          {% for listproduct in product.metafields.custom.upsell_products.value %}
                            {% assign variant = listproduct.selected_or_first_available_variant %}
                            {% if variant.available %}
                              <li
                                class="option_value upsell1"
                                data-value="yes"
                                data-ajax-add-to-cart="true"
                                data-item-id="{{ listproduct.selected_or_first_available_variant.id }}"
                                data-item-price="{{ listproduct.selected_or_first_available_variant.price }}"
                                data-bulb-qty="{{ product.metafields.custom.upsell_product_quantity.value }}"
                                data-add-to-cart-text="Add to Cart"
                              >
                                <div class="upsell-img">
                                  <img src="{{ listproduct.featured_image | img_url:'100x' }}">
                                </div>
                                {% assign upsell_quantity = product.metafields.custom.upsell_product_quantity.value
                                  | default: 1
                                %}
                                {% assign total_price = listproduct.selected_or_first_available_variant.price
                                  | times: upsell_quantity
                                %}
                                {% comment %} {{ total_price | money }} {% endcomment %}
                                <div class="product_title">
                                  Yes. {{ listproduct.title }} (+{{ total_price | money_with_currency }})
                                </div>
                              </li>
                            {% endif %}
                          {% endfor %}
                          <li class="option_value upsell1" data-value="no">
                            <div class="upsell-img none-img">
                              <img class="no-image" src="{{'no-img.png'| asset_url }} ">
                            </div>
                            <div>No</div>
                          </li>
                        </ul>
                      </div>
                    </div>
                  </div>
                {% endif %}
              {% endcapture %}
              
              {%- assign product_form_present = true -%}
              <div class="buy-buttons-row" {{ block.shopify_attributes }}>
                {% form 'product', product, id: product_form_id, class: 'form product-purchase-form', data-product-id: product.id %}
                  {{- original_select -}}

                  {% if product.available %}
                    {%- liquid
                      assign enable_dynamic_payment_button = false
                      if block.settings.enable_payment_button and product.selling_plan_groups == empty
                        unless product.template_suffix contains 'preorder'
                          assign enable_dynamic_payment_button = true
                        endunless
                      endif
                    -%}
                    <div class="quantity-submit-row input-row {% if enable_dynamic_payment_button %}has-spb{% endif %}">
                      {% if block.settings.show_quantity_selector %}
                        <label class="label" for="quantity">{{ 'products.product.quantity' | t }}</label>
                        <div class="quantity-wrapper">
                          <a href="#" data-quantity="down">{% render 'svg-minus' %}</a>
                          <input aria-label="{{ 'products.product.quantity' | t }}" id="quantity" type="number" name="quantity" value="1" />
                          <a href="#" data-quantity="up">{% render 'svg-plus' %}</a>
                          <div id="swym-atw-button-container" class="swym-atw-button-container align-center default-position consent-given">
                          <button id="swym-atw-pdp-button" 
                            class="atw-button atw-button-add-color atw-button-add full-width show-btn-text disabled swym-added swym-adding swym-loaded swym-removing"
                            data-swaction="addToWishlist"
                            data-product-id="{{ product.id }}"
                            data-variant-id="{{ product.selected_or_first_available_variant.id }}"
                            aria-label="Add to Wishlist" style="font-size: 16px; font-family: &quot;Nunito Sans&quot;, sans-serif; font-weight: 400; letter-spacing: 1.28px;">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" id="swym-atw-pdp-button-icon" class="atw-button-icon">
                              <path d="M17.4816 1.92004H6.5184C5.79952 1.93016 5.11396 2.22482 4.61192 2.73945C4.10989 3.25409 3.83231 3.94673 3.84 4.66564V20.352C3.83807 20.6653 3.92797 20.9723 4.09858 21.235C4.26919 21.4978 4.51304 21.7048 4.8 21.8304C5.07244 21.9592 5.3772 22.0033 5.67496 21.9571C5.97271 21.9109 6.24978 21.7765 6.4704 21.5712L11.6064 17.0208C11.7237 16.9274 11.8692 16.8765 12.0192 16.8765C12.1692 16.8765 12.3147 16.9274 12.432 17.0208L17.568 21.5712C17.7899 21.7742 18.0669 21.9071 18.364 21.9532C18.6612 21.9993 18.9654 21.9566 19.2384 21.8304C19.5254 21.7048 19.7692 21.4978 19.9398 21.235C20.1104 20.9723 20.2003 20.6653 20.1984 20.352V4.66564C20.2022 4.30645 20.1347 3.95007 19.9999 3.61712C19.8651 3.28417 19.6656 2.98127 19.4129 2.72593C19.1603 2.47059 18.8595 2.2679 18.528 2.12957C18.1965 1.99124 17.8408 1.92002 17.4816 1.92004ZM19.2 20.352C19.204 20.4785 19.1706 20.6033 19.104 20.7109C19.0374 20.8185 18.9406 20.904 18.8256 20.9568C18.7209 21.0062 18.6039 21.0234 18.4894 21.0063C18.375 20.9892 18.2681 20.9386 18.1824 20.8608L13.0464 16.32C12.7537 16.073 12.383 15.9375 12 15.9375C11.617 15.9375 11.2463 16.073 10.9536 16.32L5.8176 20.8608C5.73188 20.9386 5.62503 20.9892 5.51055 21.0063C5.39607 21.0234 5.2791 21.0062 5.1744 20.9568C5.05943 20.904 4.96258 20.8185 4.89599 20.7109C4.82939 20.6033 4.796 20.4785 4.8 20.352V4.66564C4.79228 4.20133 4.96871 3.75284 5.29072 3.41823C5.61273 3.08363 6.05413 2.89013 6.5184 2.88004H17.4816C17.9459 2.89013 18.3873 3.08363 18.7093 3.41823C19.0313 3.75284 19.2077 4.20133 19.2 4.66564V20.352Z" fill="black"/>
                            </svg>
                            <span>Add to Project</span>
                          </button>
                          </div>
                        </div>
                      {% endif %}



                      <!-- old unused code for backup start -->
                      {% if false and product.metafields.custom.upsell_products.value != blank %}
                      <div class="upsell-row">
                        
                        <style>
                          .upsell-row {margin-top: 1rem;}
                          .upsell-row li {
                            list-style-type: none;
                          }
                          .upsell-select:after {
                              border-bottom: 2px solid #999;
                              border-right: 2px solid #999;
                              content: ""; display: block; height: 5px;margin-top: -4px;pointer-events: none;
                              position: absolute;right: 12px; top: 50%;transform-origin: 66% 66%;
                              transform: rotate(45deg);transition: all .15s ease-in-out;width: 5px;
                          }
                          .upsell-select.open:after {
                              transform: rotate(-135deg);
                          }
                          .upsell-dropdown{
                            width: 100%;position: absolute;opacity: 0; background: #fff; visibility: hidden;transform: scale(0.75) translateY(19px); transition: all .2s cubic-bezier(0.5, 0, 0, 1.25), opacity .15s ease-out;
                            box-shadow: 0 0 0 1px rgba(68,68,68,.11);margin-top: 4px;border-radius: 5px; z-index: 1;}
                          .upsell-select{position: relative;}
                          .option_value, .option-value{font-size: 14px;}
                          .Bulbselected{color:#000;}
                          .Bulbselected, .option_value:hover, .option-value:hover {background: #f6f6f6;}
                          .upsell-select.open .upsell-dropdown { opacity: 1;visibility: visible;transform: scale(1) translateY(0);}
                          .current-option{cursor: pointer;display: flex; align-items: center; gap: 1rem;padding: .5rem 28px .5rem 18px; border: solid 1px #e8e8e8;background: #fff; border-radius: 5px; }
                          .upsell-img{width: 2.6rem; height: auto;}
                          .option_value{display: flex; align-items: center; gap: 1rem;padding: .5rem 30px .5rem 18px;cursor: pointer;}
                          .add-item{margin: 0;}
                          .none-img{display: flex;align-items: center;justify-content: center;height: 3.45rem;}
                          .no-image{width: 24px !important;height: 24px !important;}
                          .current-option .no-small-img{width: 25px;height: 25px !important;}
                          .current-option-img-wrapper{width: 2.6rem;height: auto;display: flex; align-items: center;justify-content: center}
                          .current-option-img-wrapper img{max-width: 100%;height: 100%;}
                          .current-option .small-img{width: 25px;height: 25px !important;}
                          .upsell-dropdown .upsell-img img{width: 3rem; height: 100%;display: block;}
                          .current-option .small-img-wrapper{height: 3.45rem;}
                          .add-light-title{margin-bottom: 5px;}

                        </style>
                        <div class="add-light-title">Include required bulbs?</div>
                        <div class="upsell-select">
                          <div id="current-option" class="current-option option-value" data-value=""> 
                            <div class="current-option-img-wrapper"> <img class="upsell-img current-option-img" src="path_to_default_image.jpg" alt="Default Option Image"> </div>
                            <div id="upsell-detail">UpsellProduct</div> 
                          </div>
                          <div class="upsell-dropdown">
                            <ul id="add-light" class="add-item" >
                              {% for listproduct in product.metafields.custom.upsell_products.value %}
                                 {% assign variant = listproduct.selected_or_first_available_variant %}
                                {% if variant.available %}
                                <li class="option_value" data-value="yes" data-ajax-add-to-cart="true" data-item-id="{{ listproduct.selected_or_first_available_variant.id }}" data-item-price="{{ listproduct.selected_or_first_available_variant.price }}" data-bulb-qty="{{ product.metafields.custom.upsell_product_quantity.value }}" data-add-to-cart-text="Add to Cart">
                                <div class="upsell-img"><img src="{{ listproduct.featured_image | img_url:'100x' }}"></div>
                                  {% assign upsell_quantity = product.metafields.custom.upsell_product_quantity.value | default: 1 %}
                                  {% assign total_price = listproduct.selected_or_first_available_variant.price | times: upsell_quantity %}
                                 {% comment %} {{ total_price | money }} {% endcomment %}
                                <div class="product_title" > Yes. {{ listproduct.title }} (+{{ total_price | money_with_currency }}) </div>
                                </li>

                                {% endif %}
                            {% endfor %}
                            <li class="option_value" data-value ="no"><div class="upsell-img none-img"><img class="no-image" src="{{'no-img.png'| asset_url }} "></div> <div>No</div> </li>
                            </ul>
                          </div>
                        </div>
                      </div>
                      {% endif %}
                      <!-- old unused code for backup end -->

                      {{ upsells_html }} 

                      {% comment %} <div id="add-to-cart-button" class="quantity-submit-row__submit input-row">
                        {%- capture add_to_cart_text -%}
                          {%- if product.template_suffix contains 'preorder' -%}
                            {{- 'products.product.preorder' | t -}}
                          {%- else -%}
                            {{- 'products.product.add_to_cart' | t -}}
                          {%- endif -%}
                        {%- endcapture -%}
                        <button class="button button--large{% if current_variant.available == false %} button--sold-out{% endif %} add-to-cart " type="submit" data-add-to-cart-text="{{ add_to_cart_text | escape }}">
                          {%- if current_variant.available -%}
                            {{- add_to_cart_text -}}
                          {%- else -%}
                            {{- 'products.variant.no_stock' | t -}}
                          {%- endif -%}
                        </button>
                      </div> {% endcomment %}
                      <div class="quantity-submit-row__submit input-row">
                      <div class="js-form-error lightly-spaced-row" role="alert" hidden></div>

                      {%- capture add_to_cart_text -%}
                        {%- if product.template_suffix contains 'preorder' -%}
                          {{- 'products.product.preorder' | t -}}
                        {%- else -%}
                          {{- 'products.product.add_to_cart' | t -}}
                        {%- endif -%}
                      {%- endcapture -%}
                      <button class="btn btn--large add-to-cart" type="submit" name="add" data-add-to-cart-text="{{ add_to_cart_text | escape }}"{% if product.available == false %} disabled{% endif %}>
                        {%- if current_variant.available or current_variant == false -%}
                          {{- add_to_cart_text -}}
                        {%- else -%}
                          {{- 'products.variant.no_stock' | t -}}
                        {%- endif -%}
                      </button>
                    </div>
                      
                      {% if enable_dynamic_payment_button %}
                        <script class="dynamic-payment-button-template" type="text/template">
                          {{ form | payment_button }}
                        </script>
                      {% endif %}

                      {% if block.settings.show_backorder_text == true %}
                        {% render 'backorder', product: product, variant: current_variant %}
                      {% endif %}
                    </div>

                    {%- unless block.settings.show_pickup_availability == false -%}
                      {% render 'store-availability', product: product, current_variant: current_variant %}
                    {%- endunless -%}

                  {% else %}
                     {{ upsells_html }}
                    <div class="quantity-submit-row input-row">
                      <div class="quantity-submit-row__submit">
                        <button class="button button--large button--sold-out" type="submit">
                          {{- 'products.variant.no_stock' | t -}}
                        </button>
                      </div>
                    </div>
                  {% endif %}
                {% endform %}
                <div id='wcp_vd_table'></div>
              </div>

              {% when 'estimated_delivery' %}
              {% assign variant = product.selected_variant %}

              {% assign dubai_delivery_time = variant.metafields.custom.delivery_time_for_dubai.value %}
              {% assign all_other_emirates_delivery_time = variant.metafields.custom.delivery_time_for_all_other_emirates.value %}
              {% assign saudi_delivery_time = variant.metafields.custom.delivery_time_for_gcc.value %}

              {% if dubai_delivery_time or all_other_emirates_delivery_time or saudi_delivery_time or dubai_delivery_time.value != '0' or all_other_emirates_delivery_time.value != '0' or saudi_delivery_time.value != '0' %}
                {% if variant.available and variant.inventory_policy == 'deny' or variant.inventory_quantity > 0 %}
                  <abz-estimated-delivery
                    class="estimated-delivery-block lightly-spaced-row variant_option {% if dubai_delivery_time or all_other_emirates_delivery_time or saudi_delivery_time %}{%else %}hide{% endif %}"
                    {{ block.shopify_attributes }}
                  >
                    <div class="estimated-delivery-header">
                      {% if block.settings.estimated_delivery_icon != blank %}
                        <img
                          src="{{ block.settings.estimated_delivery_icon | image_url }}"
                          alt="Delivery Icon"
                          class="estimated-delivery-icon"
                          width="{{ block.settings.estimated_delivery_icon.width }}"
                          height="{{ block.settings.estimated_delivery_icon.height }}"
                        >
                      {% endif %}
                      <span class="estimated-delivery-title label">
                        {{- block.settings.estimated_delivery_title | default: 'Estimated Delivery' -}}
                      </span>
                    </div>
                    <div class="estimated-delivery-cards">
                      {% if dubai_delivery_time %}
                        <div class="estimated-delivery-card">
                          <div class="estimated-delivery-label">{{ block.settings.dubai_delivery_dates_label }}</div>
                          <strong class="estimated-delivery-date" data-delivery-time="{{ dubai_delivery_time }}"></strong>
                        </div>
                      {% endif %}
                      {% if all_other_emirates_delivery_time %}
                        <div class="estimated-delivery-card">
                          <div class="estimated-delivery-label">
                            {{ block.settings.all_other_emirates_delivery_dates_label }}
                          </div>
                          <strong class="estimated-delivery-date" data-delivery-time="{{ all_other_emirates_delivery_time }}"></strong>
                        </div>
                      {% endif %}
                      {% if saudi_delivery_time %}
                        <div class="estimated-delivery-card">
                          <div class="estimated-delivery-label">{{ block.settings.saudi_delivery_dates_label }}</div>
                          <strong class="estimated-delivery-date" data-delivery-time="{{ saudi_delivery_time }}"></strong>
                        </div>
                      {% endif %}
                    </div>
                  </abz-estimated-delivery>
                {% endif %}
              {% endif %}
               
              
              {% assign pro_dubai_delivery_time = product.metafields.custom.delivery_time_for_dubai.value %}
              {% assign pro_all_other_emirates_delivery_time = product.metafields.custom.delivery_time_for_all_other_emirates.value %}
              {% assign pro_saudi_delivery_time = product.metafields.custom.delivery_time_for_saudi_oman_kuwait_bahrain_qatar.value %}

              {% if pro_dubai_delivery_time or pro_all_other_emirates_delivery_time or pro_saudi_delivery_time %}
                {% if product.variants.first.inventory_quantity > 0 or product.variants.first.inventory_policy == 'deny' %}
                <abz-estimated-delivery
                  class="estimated-delivery-block lightly-spaced-row"
                  {{ block.shopify_attributes }}
                >
                  <div class="estimated-delivery-header">
                    {% if block.settings.estimated_delivery_icon != blank %}
                      <img
                        src="{{ block.settings.estimated_delivery_icon | image_url }}"
                        alt="Delivery Icon"
                        class="estimated-delivery-icon"
                        width="{{ block.settings.estimated_delivery_icon.width }}"
                        height="{{ block.settings.estimated_delivery_icon.height }}"
                      >
                    {% endif %}
                    <span class="estimated-delivery-title label">
                      {{- block.settings.estimated_delivery_title | default: 'Estimated Delivery' -}}
                    </span>
                  </div>
                  <div class="estimated-delivery-cards">
                    {% if pro_dubai_delivery_time %}
                      <div class="estimated-delivery-card">
                          <div class="estimated-delivery-label">{{ block.settings.dubai_delivery_dates_label }}</div>
                          <strong class="estimated-delivery-date" data-delivery-time="{{ pro_dubai_delivery_time }}"></strong>
                        </div>
                      {% endif %}
                      {% if pro_all_other_emirates_delivery_time %}
                        <div class="estimated-delivery-card">
                          <div class="estimated-delivery-label">
                            {{ block.settings.all_other_emirates_delivery_dates_label }}
                          </div>
                          <strong
                            class="estimated-delivery-date"
                            data-delivery-time="{{ pro_all_other_emirates_delivery_time }}"
                          ></strong>
                        </div>
                      {% endif %}
                      {% if pro_saudi_delivery_time %}
                        <div class="estimated-delivery-card">
                          <div class="estimated-delivery-label">{{ block.settings.saudi_delivery_dates_label }}</div>
                          <strong class="estimated-delivery-date" data-delivery-time="{{ pro_saudi_delivery_time }}"></strong>
                        </div>
                      {% endif %}
                    </div>
                  </abz-estimated-delivery>
                {% endif %} 

                {%comment %}
                {% if product.metafields.custom.show_contact_sale %}
                <div class="meta_popup_text">
                  <span id="contact-sales-trigger" class="info_text">Contact our sales</span>
                  <span class="info_icon">
                    <svg xmlns="http://www.w3.org/2000/svg" shape-rendering="geometricPrecision" text-rendering="geometricPrecision" image-rendering="optimizeQuality" fill-rule="evenodd" clip-rule="evenodd" viewBox="0 0 512 512" style="&#10;    fill: #937e6c;&#10;"><path fill-rule="nonzero" d="M256 0c70.69 0 134.69 28.66 181.02 74.98C483.34 121.3 512 185.31 512 256c0 70.69-28.66 134.7-74.98 181.02C390.69 483.34 326.69 512 256 512c-70.69 0-134.69-28.66-181.02-74.98C28.66 390.69 0 326.69 0 256c0-70.69 28.66-134.69 74.98-181.02C121.31 28.66 185.31 0 256 0zm-9.96 161.03c0-4.28.76-8.26 2.27-11.91 1.5-3.63 3.77-6.94 6.79-9.91 3-2.95 6.29-5.2 9.84-6.7 3.57-1.5 7.41-2.28 11.52-2.28 4.12 0 7.96.78 11.49 2.27 3.54 1.51 6.78 3.76 9.75 6.73 2.95 2.97 5.16 6.26 6.64 9.91 1.49 3.63 2.22 7.61 2.22 11.89 0 4.17-.73 8.08-2.21 11.69-1.48 3.6-3.68 6.94-6.65 9.97-2.94 3.03-6.18 5.32-9.72 6.84-3.54 1.51-7.38 2.29-11.52 2.29-4.22 0-8.14-.76-11.75-2.26-3.58-1.51-6.86-3.79-9.83-6.79-2.94-3.02-5.16-6.34-6.63-9.97-1.48-3.62-2.21-7.54-2.21-11.77zm13.4 178.16c-1.11 3.97-3.35 11.76 3.3 11.76 1.44 0 3.27-.81 5.46-2.4 2.37-1.71 5.09-4.31 8.13-7.75 3.09-3.5 6.32-7.65 9.67-12.42 3.33-4.76 6.84-10.22 10.49-16.31.37-.65 1.23-.87 1.89-.48l12.36 9.18c.6.43.73 1.25.35 1.86-5.69 9.88-11.44 18.51-17.26 25.88-5.85 7.41-11.79 13.57-17.8 18.43l-.1.06c-6.02 4.88-12.19 8.55-18.51 11.01-17.58 6.81-45.36 5.7-53.32-14.83-5.02-12.96-.9-27.69 3.06-40.37l19.96-60.44c1.28-4.58 2.89-9.62 3.47-14.33.97-7.87-2.49-12.96-11.06-12.96h-17.45c-.76 0-1.38-.62-1.38-1.38l.08-.48 4.58-16.68c.16-.62.73-1.04 1.35-1.02l89.12-2.79c.76-.03 1.41.57 1.44 1.33l-.07.43-37.76 124.7zm158.3-244.93c-41.39-41.39-98.58-67-161.74-67-63.16 0-120.35 25.61-161.74 67-41.39 41.39-67 98.58-67 161.74 0 63.16 25.61 120.35 67 161.74 41.39 41.39 98.58 67 161.74 67 63.16 0 120.35-25.61 161.74-67 41.39-41.39 67-98.58 67-161.74 0-63.16-25.61-120.35-67-161.74z"/></svg>
                    <span class="tooltip_text">Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book.</span>
                  </span>   
                </div>
                
                {% endif %}
                 {% endcomment %}
              {% endif %}

              {% when 'popup_content' %}
              {% if product.metafields.custom.show_contact_sale %}
                <div class="meta_popup_text">
                  <span id="contact-sales-trigger" class="info_text">
                      Customisable within 60 - 90 days
                  </span>
                  <span id="info_icon" class="info_icon">
                    <svg xmlns="http://www.w3.org/2000/svg" shape-rendering="geometricPrecision" text-rendering="geometricPrecision" image-rendering="optimizeQuality" fill-rule="evenodd" clip-rule="evenodd" viewBox="0 0 512 512" style="&#10;    fill: #937e6c;&#10;"><path fill-rule="nonzero" d="M256 0c70.69 0 134.69 28.66 181.02 74.98C483.34 121.3 512 185.31 512 256c0 70.69-28.66 134.7-74.98 181.02C390.69 483.34 326.69 512 256 512c-70.69 0-134.69-28.66-181.02-74.98C28.66 390.69 0 326.69 0 256c0-70.69 28.66-134.69 74.98-181.02C121.31 28.66 185.31 0 256 0zm-9.96 161.03c0-4.28.76-8.26 2.27-11.91 1.5-3.63 3.77-6.94 6.79-9.91 3-2.95 6.29-5.2 9.84-6.7 3.57-1.5 7.41-2.28 11.52-2.28 4.12 0 7.96.78 11.49 2.27 3.54 1.51 6.78 3.76 9.75 6.73 2.95 2.97 5.16 6.26 6.64 9.91 1.49 3.63 2.22 7.61 2.22 11.89 0 4.17-.73 8.08-2.21 11.69-1.48 3.6-3.68 6.94-6.65 9.97-2.94 3.03-6.18 5.32-9.72 6.84-3.54 1.51-7.38 2.29-11.52 2.29-4.22 0-8.14-.76-11.75-2.26-3.58-1.51-6.86-3.79-9.83-6.79-2.94-3.02-5.16-6.34-6.63-9.97-1.48-3.62-2.21-7.54-2.21-11.77zm13.4 178.16c-1.11 3.97-3.35 11.76 3.3 11.76 1.44 0 3.27-.81 5.46-2.4 2.37-1.71 5.09-4.31 8.13-7.75 3.09-3.5 6.32-7.65 9.67-12.42 3.33-4.76 6.84-10.22 10.49-16.31.37-.65 1.23-.87 1.89-.48l12.36 9.18c.6.43.73 1.25.35 1.86-5.69 9.88-11.44 18.51-17.26 25.88-5.85 7.41-11.79 13.57-17.8 18.43l-.1.06c-6.02 4.88-12.19 8.55-18.51 11.01-17.58 6.81-45.36 5.7-53.32-14.83-5.02-12.96-.9-27.69 3.06-40.37l19.96-60.44c1.28-4.58 2.89-9.62 3.47-14.33.97-7.87-2.49-12.96-11.06-12.96h-17.45c-.76 0-1.38-.62-1.38-1.38l.08-.48 4.58-16.68c.16-.62.73-1.04 1.35-1.02l89.12-2.79c.76-.03 1.41.57 1.44 1.33l-.07.43-37.76 124.7zm158.3-244.93c-41.39-41.39-98.58-67-161.74-67-63.16 0-120.35 25.61-161.74 67-41.39 41.39-67 98.58-67 161.74 0 63.16 25.61 120.35 67 161.74 41.39 41.39 98.58 67 161.74 67 63.16 0 120.35-25.61 161.74-67 41.39-41.39 67-98.58 67-161.74 0-63.16-25.61-120.35-67-161.74z"/></svg>
                  </span>
                </div>
                
                <div class="popup-overlay" id="popup">
                    <div class="popup-box">
                      <span class="popup-close" id="popup-close">
                        <img src="https://cdn.shopify.com/s/files/1/0161/5003/6580/files/icons8-multiply-26.png?v=1759134499"/>
                      </span>
                      <div class="popup_content">{{ block.settings.Popup_title }}</div>
                      <p>{{ block.settings.popup_content }}</p>
                      <a href="https://loomcollection.freshdesk.com/en/support/tickets/new?ticket_form=uphostery_customisation_-_made_to_order" 
                          target="_blank" 
                          class="popup-btn">
                          Contact Us
                      </a>
                    </div>
                  </div>
                  <style>
                  .popup-overlay {
                    display: none;
                    position: fixed;
                    inset: 0;
                    background: rgba(0,0,0,0.6);
                    z-index: 1000;
                  }
                  .popup-box {
                    position: absolute;
                    top: 50%; left: 50%;
                    transform: translate(-50%, -50%);
                    background: #fff;
                    padding: 20px 30px;
                    border: 1px solid #dbdbdb;
                    max-width: 400px;
                    width: 90%;
                    text-align: center;
                  }
                  .popup-close {
                      position: absolute;
                      top: 10px;
                      right: 10px;
                      cursor: pointer;
                      width: 14px;
                      height: 14px;
                  }
                  .popup-btn {
                    display: inline-block;
                    width: 70%;
                    padding: 10px 20px;
                    background: #937e6c;
                    color: #fff;
                    text-decoration: none;
                    border-radius: 5px;
                  }
                  .popup_content {
                      font-size: 20px;
                      font-weight: 600;
                      line-height: 30px;
                  }
                  span#info_icon {
                      cursor: pointer;
                  }
                  </style> 
                  <script>
                  document.addEventListener("DOMContentLoaded", function() {
                    const trigger = document.getElementById("info_icon");
                    const popup = document.getElementById("popup");
                    const closeBtn = document.getElementById("popup-close");

                    if (trigger && popup && closeBtn) {
                      trigger.addEventListener("click", function() {
                        popup.style.display = "block";
                      });

                      closeBtn.addEventListener("click", function() {
                        popup.style.display = "none";
                      });

                      popup.addEventListener("click", function(e) {
                        if (e.target === popup) {
                          popup.style.display = "none";
                        }
                      });
                    }
                  });
                  </script>
                {% endif %}

            {% when 'inventory_level' %}
              <div class="variant-visibility-area{% unless block.settings.show_in_quickbuy %} not-in-quickbuy{% endunless %}" {{ block.shopify_attributes }}>
                {%- for variant in product.variants -%}
                  {% if variant.inventory_management != blank and variant.inventory_quantity > 0 %}
                    {% if block.settings.show_inventory_notice == 'always' or variant.inventory_quantity <= block.settings.inventory_threshold %}
                      <script type="text/template" data-variant-id="{{ variant.id }}">
                        {%- liquid
                          assign show_inventory_count = false
                          if block.settings.show_inventory_count == 'always'
                            assign show_inventory_count = true
                          endif
                          if block.settings.show_inventory_count == 'low' and variant.inventory_quantity <= block.settings.inventory_threshold
                            assign show_inventory_count = true
                          endif

                          if show_inventory_count
                            if variant.inventory_quantity <= block.settings.inventory_threshold
                              assign notice = 'products.labels.only_x_left' | t: quantity: variant.inventory_quantity
                            else
                              assign notice = 'products.labels.x_units_available' | t: quantity: variant.inventory_quantity
                            endif
                          else
                            if variant.inventory_quantity <= block.settings.inventory_threshold
                              assign notice = 'products.labels.low_stock' | t
                            else
                              assign notice = 'products.labels.in_stock' | t
                            endif
                          endif
                        -%}
                        {%- capture notice_html -%}
                          <div class="lightly-spaced-row">
                            <div class="product-info-block product-inventory-notice {% if block.settings.enable_pulse %}product-inventory-notice--pulse{% endif %} product-inventory-notice--{% if variant.inventory_quantity <= block.settings.inventory_threshold %}low{% else %}ok{% endif %} with-icon{% if block.settings.enable_box %} text-box{% endif %}">
                              <div class="icon-container">
                                {%- if variant.inventory_quantity <= block.settings.inventory_threshold -%}
                                  {%- render 'icon', icon: 'clock', size: 'small' -%}
                                {%- else -%}
                                  {%- render 'icon', icon: 'check_mark_in_circle', size: 'small' -%}
                                {%- endif -%}
                              </div>
                              <span class="with-icon__beside">{{ notice }}</span>
                            </div>
                          </div>
                        {%- endcapture -%}
                        {{- notice_html -}}
                      </script>
                      {%- if variant.id == current_variant.id -%}
                        {{- notice_html -}}
                      {%- endif -%}
                    {% endif %}
                  {% endif %}
                {%- endfor -%}
              </div>

            {% when 'accordion' %}
              {%- liquid
                 assign content = block.settings.content
                if block.settings.page != blank
                  assign content = pages[block.settings.page].content
                endif
              -%}
              {%- if content != blank -%}
                <div class="product-detail-accordion{% unless block.settings.show_in_quickbuy %} not-in-quickbuy{% endunless %}" {{ block.shopify_attributes }}>
                  {%- capture accordion_title -%}
                    {%- if block.settings.icon == blank -%}
                      {{- block.settings.title | escape -}}
                    {%- else -%}
                      <div class="with-icon">
                        {% render 'icon', icon: block.settings.icon, size: 'small' %}
                        <span class="with-icon__beside">{{ block.settings.title }}</span>
                      </div>
                    {%- endif -%}
                  {%- endcapture -%}
                  {% render 'accordion', allow_multi_open: true, add_content_class: 'rte cf', first_item_open: block.settings.open, item1_title: accordion_title, item1_content: content, classTitle: block.settings.title %}
                </div>
              {%- endif -%}

            {% when 'text' %}
              {% if block.settings.text != blank %}
                <div class="lightly-spaced-row{% unless block.settings.show_in_quickbuy %} not-in-quickbuy{% endunless %}" {{ block.shopify_attributes }}>
                  {%- liquid
                    if block.settings.enable_box
                      assign box_color_brightness = block.settings.box_color | color_brightness
                      if box_color_brightness > 128
                        assign box_color_saturation = block.settings.box_color | color_extract: 'saturation'
                        if box_color_saturation > 0
                          assign text_col = block.settings.box_color | color_darken: 60 | color_saturate: 30 | color_to_rgb | split: '(' | last | split: ')' | first
                        else
                          assign text_col = block.settings.box_color | color_darken: 60 | color_to_rgb | split: '(' | last | split: ')' | first
                        endif
                      else
                        assign text_col = '255,255,255'
                      endif
                    endif
                  -%}
                  <div class="product-info-block{% if block.settings.icon != blank or block.settings.custom_icon != blank %} with-icon{% endif %}{% if block.settings.enable_box %} text-box{% endif %}" {% if block.settings.enable_box %}style="--box-color: {{ block.settings.box_color }}; --box-text-color: {{ text_col }}"{% endif %}>
                    {%- if block.settings.icon == blank and block.settings.custom_icon == blank -%}
                      {{- block.settings.text -}}
                    {%- else -%}
                      {% if block.settings.custom_icon == blank %}
                        {% render 'icon', icon: block.settings.icon, size: block.settings.icon_size %}
                      {% else %}
                        <span class="icon icon--image icon--{{ block.settings.icon_size }}">{% render 'responsive-image', image: block.settings.custom_icon %}</span>
                      {% endif %}
                      <span class="with-icon__beside">{{ block.settings.text }}</span>
                    {%- endif -%}
                  </div>
                </div>
              {% endif %}

            {% when 'richtext' %}
              {% if block.settings.richtext != blank %}
                <div class="lightly-spaced-row{% unless block.settings.show_in_quickbuy %} not-in-quickbuy{% endunless %}" {{ block.shopify_attributes }}>
                  {%- liquid
                    if block.settings.enable_box
                      assign box_color_brightness = block.settings.box_color | color_brightness
                      if box_color_brightness > 128
                        assign box_color_saturation = block.settings.box_color | color_extract: 'saturation'
                        if box_color_saturation > 0
                          assign text_col = block.settings.box_color | color_darken: 60 | color_saturate: 30 | color_to_rgb | split: '(' | last | split: ')' | first
                        else
                          assign text_col = block.settings.box_color | color_darken: 60 | color_to_rgb | split: '(' | last | split: ')' | first
                        endif
                      else
                        assign text_col = '255,255,255'
                      endif
                    endif
                  -%}
                  <div class="product-info-block{% if block.settings.icon != blank or block.settings.custom_icon != blank %} with-icon{% endif %}{% if block.settings.enable_box %} text-box{% endif %}" {% if block.settings.enable_box %}style="--box-color: {{ block.settings.box_color }}; --box-text-color: {{ text_col }}"{% endif %}>
                    {%- if block.settings.icon == blank and block.settings.custom_icon == blank -%}
                      <div class="rte cf">{{ block.settings.richtext }}</div>
                    {%- else -%}
                      {% if block.settings.custom_icon == blank %}
                        {% render 'icon', icon: block.settings.icon, size: block.settings.icon_size %}
                      {% else %}
                        <span class="icon icon--image icon--{{ block.settings.icon_size }}">{% render 'responsive-image', image: block.settings.custom_icon %}</span>
                      {% endif %}
                      <div class="with-icon__beside rte cf">{{ block.settings.richtext }}</div>
                    {%- endif -%}
                  </div>
                </div>
              {% endif %}

            {% when 'popup' %}
              {% if block.settings.page != blank %}
                <div class="lightly-spaced-row{% unless block.settings.show_in_quickbuy %} not-in-quickbuy{% endunless %}" {{ block.shopify_attributes }}>
                  <a class="{% if block.settings.style != 'link' %}btn btn--{{ block.settings.style }}{% else %}small-feature-link{% endif %} cc-modal" href="{{ pages[block.settings.page].url }}" target="_blank" data-cc-modal-contentelement="#block-content-{{ section.id }}-{{ block.id }}">{{ block.settings.text | escape }}</a>
                  <div id="block-content-{{ section.id }}-{{ block.id }}" class="hidden">
                    <div class="rte cf">{{ pages[block.settings.page].content }}</div>
                  </div>
                </div>
              {% endif %}

            {% when 'link' %}
              {% if block.settings.text != blank %}
                <div class="lightly-spaced-row{% unless block.settings.show_in_quickbuy %} not-in-quickbuy{% endunless %}" {{ block.shopify_attributes }}>
                  <a class="{% if block.settings.style != 'link' %}btn btn--{{ block.settings.style }}{% else %}small-feature-link{% endif %}" href="{{ block.settings.url }}"{% if block.settings.open_in_new_tab %} target="_blank"{% endif %}>{{ block.settings.text | escape }}</a>
                </div>
              {% endif %}

            {% when 'image' %}
              {% if block.settings.image != blank %}
                <div class="lightly-spaced-row inline-width-container{% unless block.settings.show_in_quickbuy %} not-in-quickbuy{% endunless %}" style="width: {{ block.settings.image_width }}px" {{ block.shopify_attributes }}>
                  {% if block.settings.url != blank %}<a href="{{ block.settings.url }}"{% if block.settings.open_in_new_tab %} target="_blank"{% endif %}>{% endif %}
                    {% render 'responsive-image', image: block.settings.image %}
                  {% if block.settings.url != blank %}</a>{% endif %}
                </div>
              {% endif %}

            {% when 'custom_liquid' %}
              {% if block.settings.custom_liquid != blank %}
                <div class="lightly-spaced-row{% unless block.settings.show_in_quickbuy %} not-in-quickbuy{% endunless %}" {{ block.shopify_attributes }}>{{ block.settings.custom_liquid }}</div>
              {% endif %}

            {% when 'sharing' %}
              <div class="lightly-spaced-row not-in-quickbuy" {{ block.shopify_attributes }}>
                {% render 'social-sharing', share_title: product.title, share_permalink: product.url, share_image: product %}
              </div>

            {% when 'divider' %}
              <hr {% unless block.settings.show_in_quickbuy %}class="not-in-quickbuy"{% endunless %} {{ block.shopify_attributes }}>

            {% when 'custom_option' %}
              {%- if block.settings.label != blank -%}
                {%- liquid
                  assign custom_option_input_id = product_form_id | append: '-custom-' | append: forloop.index
                  assign custom_input_name = block.settings.label | escape | prepend: 'properties[' | append: ']'
                -%}
                <div class="custom-option" {{ block.shopify_attributes}}>
                  {% case block.settings.type %}
                    {% when 'text' %}
                      <div class="option-selector">
                        <label class="label" for="{{ custom_option_input_id }}">{{ block.settings.label | escape }}</label>
                        <input class="custom-option__text-input" type="text" id="{{ custom_option_input_id }}" form="{{ product_form_id }}" name="{{ custom_input_name }}" {% if block.settings.text_required %}required{% endif %}>
                      </div>

                    {% when 'textarea' %}
                      <div class="option-selector">
                        <label class="label" for="{{ custom_option_input_id }}">{{ block.settings.label | escape }}</label>
                        <textarea class="custom-option__text-input" id="{{ custom_option_input_id }}" form="{{ product_form_id }}" name="{{ custom_input_name }}" {% if block.settings.text_required %}required{% endif %}></textarea>
                      </div>

                    {% when 'checkbox' %}
                      <div class="option-selector">
                        <label class="label">
                          <input type="hidden" form="{{ product_form_id }}" name="{{ custom_input_name }}" value="{{ block.settings.checkbox_unchecked_value | escape }}">
                          <input type="checkbox" form="{{ product_form_id }}" name="{{ custom_input_name }}" value="{{ block.settings.checkbox_checked_value | escape }}">
                          <span class="label__text-beside-input">{{ block.settings.label | escape }}</span>
                        </label>
                      </div>

                    {% when 'multiple' %}
                      {%- assign custom_options = block.settings.multiple_options | newline_to_br | strip_newlines | split: '<br />' -%}

                      {% if block.settings.multiple_style == 'dropdown' %}
                        <div class="option-selector" data-selector-type="dropdown">
                          {% render 'custom-select',
                            id: custom_option_input_id,
                            label: block.settings.label,
                            option_values: custom_options,
                            selected_value: custom_options.first,
                            include_native: true,
                            native_name: custom_input_name,
                            native_form_id: product_form_id
                          %}
                        </div>

                      {% else %}
                        <div class="option-selector" data-selector-type="radio">
                          <fieldset>
                            <legend class="label">{{ block.settings.label | escape }}</legend>
                            {% for option in custom_options %}
                              <label class="label">
                                <input type="radio" form="{{ product_form_id }}" name="{{ custom_input_name }}" value="{{ option | escape }}"{% if forloop.first %} checked{% endif %}>
                                <span class="label__text-beside-input">{{ option | escape }}</span>
                              </label>
                            {% endfor %}
                          </fieldset>
                        </div>
                      {% endif %}

                  {% endcase %}
                </div>
              {%- endif -%}

            {% when 'related_products' %}
              {% if block.settings.product_list != blank %}
                <div class="lightly-spaced-row lightish-spaced-row-above not-in-quickbuy" {{ block.shopify_attributes }}>
                  <div class="label">{{ block.settings.title | escape }}</div>
                  <div class="fixed-layout">
                    {%- liquid
                      if settings.prod_thumb_shape == 'portrait-23'
                        assign chosen_aspect_ratio = 0.67
                      elsif settings.prod_thumb_shape == 'portrait-45'
                        assign chosen_aspect_ratio = 0.8
                      elsif settings.prod_thumb_shape == 'square'
                        assign chosen_aspect_ratio = 1.0
                      elsif settings.prod_thumb_shape == 'landscape-54'
                        assign chosen_aspect_ratio = 1.25
                      elsif settings.prod_thumb_shape == 'landscape-32'
                        assign chosen_aspect_ratio = 1.50
                      elsif settings.prod_thumb_shape == 'tallest'
                        assign chosen_aspect_ratio = 99
                        for product in block.settings.product_list
                          if product.featured_media.preview_image.aspect_ratio < chosen_aspect_ratio
                            assign chosen_aspect_ratio = product.featured_media.preview_image.aspect_ratio
                          endif
                        endfor
                      else
                        assign chosen_aspect_ratio = 0
                        for product in block.settings.product_list
                          if product.featured_media.preview_image.aspect_ratio > chosen_aspect_ratio
                            assign chosen_aspect_ratio = product.featured_media.preview_image.aspect_ratio
                          endif
                        endfor
                      endif

                      for related_product in block.settings.product_list
                        echo '<div class="column column--half">'
                        render 'product-block', product: related_product, no_quick_buy: true, custom_aspect_ratio: chosen_aspect_ratio
                        echo '</div>'
                      endfor
                    -%}
                  </div>
                </div>
              {% endif %}

            {% when 'complementary' %}
              <cc-fetched-content class="not-in-quickbuy" data-id="{{ block.id }}" data-url="{{ routes.product_recommendations_url }}?section_id={{ section.id }}&product_id={{ product.id }}&intent=complementary" contains-product-blocks {{ block.shopify_attributes }}>
                {%- if recommendations.performed and recommendations.products_count > 0 -%}
                  {%- liquid
                    if settings.prod_thumb_shape == 'portrait-23'
                      assign chosen_aspect_ratio = 0.67
                    elsif settings.prod_thumb_shape == 'portrait-45'
                      assign chosen_aspect_ratio = 0.8
                    elsif settings.prod_thumb_shape == 'square'
                      assign chosen_aspect_ratio = 1.0
                    elsif settings.prod_thumb_shape == 'landscape-54'
                      assign chosen_aspect_ratio = 1.25
                    elsif settings.prod_thumb_shape == 'landscape-32'
                      assign chosen_aspect_ratio = 1.50
                    elsif settings.prod_thumb_shape == 'tallest'
                      assign chosen_aspect_ratio = 99
                      for product in recommendations.products limit: block.settings.max_products
                        if product.featured_media.preview_image.aspect_ratio < chosen_aspect_ratio
                          assign chosen_aspect_ratio = product.featured_media.preview_image.aspect_ratio
                        endif
                      endfor
                    else
                      assign chosen_aspect_ratio = 0
                      for product in recommendations.products limit: block.settings.max_products
                        if product.featured_media.preview_image.aspect_ratio > chosen_aspect_ratio
                          assign chosen_aspect_ratio = product.featured_media.preview_image.aspect_ratio
                        endif
                      endfor
                    endif
                  -%}

                  <div class="lightly-spaced-row lightish-spaced-row-above not-in-quickbuy">
                    {% if block.settings.enable_carousel and recommendations.products_count > 2 and block.settings.max_products > 2 %}
                      <div class="collection-slider collection-slider--no-wide-gutter">
                        <div class="opposing-items opposing-items--valign-base very-lightly-spaced-row">
                          <div class="opposing-items__left label">{{ block.settings.block_heading | escape }}</div>
                          <div class="no-wrap">
                            <a class="prev ltr-icon inh-col" href="#">{% render 'svg-chevron-left' %}</a>
                            <a class="next ltr-icon inh-col" href="#">{% render 'svg-chevron-right' %}</a>
                          </div>
                        </div>
                        <div class="collection-listing">
                          <div class="product-list product-list--image-shape-{{ settings.prod_thumb_shape }} carousel carousel--fixed-grid-mode carousel--per-row-2">
                            {%- liquid
                              for related_product in recommendations.products limit: block.settings.max_products
                                render 'product-block', product: related_product, manual_image_load: true, no_quick_buy: true, no_swiping: true, custom_aspect_ratio: chosen_aspect_ratio
                              endfor
                            -%}
                          </div>
                        </div>
                      </div>
                    {% else %}
                      <div class="very-lightly-spaced-row">
                        <div class="label">{{ block.settings.block_heading | escape }}</div>
                      </div>
                      <div class="fixed-layout fixed-layout--no-wide-gutter">
                        {%- liquid
                          for related_product in recommendations.products limit: block.settings.max_products
                            echo '<div class="column column--half">'
                            render 'product-block', product: related_product, manual_image_load: false, no_quick_buy: true, custom_aspect_ratio: chosen_aspect_ratio
                            echo '</div>'
                          endfor
                        -%}
                      </div>
                    {% endif %}
                  </div>
                {%- endif -%}
              </cc-fetched-content>

          {% endcase %}
        {% endfor %}

        {%- if product_form_present == false -%}
          <form class="product-purchase-form hidden" data-product-id="{{ product.id }}">
            {{- original_select -}}
          </form>
        {%- endif -%}

        <div class="lightish-spaced-row-above only-in-quickbuy">
          <a class="more" href="{{ product.url }}">
            <span class="beside-svg underline">{{ 'products.quick_buy.read_more' | t }}</span>
            <span class="icon--small icon-natcol ltr-icon">{% render 'svg-chevron-right' %}</span>
          </a>
        </div>
      </div>

      <script type="application/json" id="ProductJson-{{ product.id }}">
        {{- product | json -}}
      </script>
    </div>
  </div><!-- /.product-detail -->

  {% if section.settings.show_location_underneath %}
    <div class="product-description rte container cf padded-row not-in-quickbuy">{{ product.description }}</div>
  {% endif %}
</div>

{% render 'structured-data-product', product: product, current_variant: product.selected_or_first_available_variant %}

<div class="stickey-addtocart-bar">

  <div class="stickey-addtocart-bar-inner" data-section-type="main-product" data-components="accordion,custom-select,modal">
  
  <div class="product-detail quickbuy-content container{% if current_variant.compare_at_price > current_variant.price %} variant-status--on-sale{% endif %}{% if current_variant.available == false %} variant-status--unavailable{% endif %}">
  
    <div class="detail product-column-right" data-cc-animate data-cc-animate-delay="0.2s">
      <div class="product-form{% if section.settings.enable_sticky_columns %} sticky-content-container{% endif %}" data-ajax-add-to-cart="true" data-product-id="{{ product.id }}" data-enable-history-state="true">
        {%- assign product_form_present = false -%}
        {%- capture original_select -%}
          <select name="id" class="original-selector{% if product.variants.size == 1 %} hidden{% endif %}" aria-label="{{ 'products.product.selector_label' | t | escape }}">
            {% if product.variants.size > 1 %}<option value="">{{ 'products.product.no_selection' | t }}</option>{% endif %}
            {% for variant in product.variants %}
            <option value="{{ variant.id }}"
              {% if variant == current_variant %} selected="selected"{% endif %}
              {% if section.settings.inventory_transfers_enable and variant.incoming %}
                {%- if variant.next_incoming_date -%}
                  {%- assign date = variant.next_incoming_date | date: format: 'date' -%}
                  {%- if variant.available -%}
                    data-inventory-transfer="{{ 'products.transfers.will_not_ship_until' | t: date: date | escape }}"
                  {%- else -%}
                    data-inventory-transfer="{{ 'products.transfers.will_be_in_stock_after' | t: date: date | escape }}"
                  {%- endif -%}
                {%- else -%}
                  data-inventory-transfer="{{ 'products.transfers.waiting_for_stock' | t | escape }}"
                {%- endif -%}
              {% endif %}
              data-stock="{% if variant.inventory_management != blank and variant.inventory_quantity <= 0 %}out{% endif %}">{{ variant.title | escape }}</option>
            {% endfor %}
          </select>
        {%- endcapture -%}

        {% for block in section.blocks %}
          {% case block.type %}
         
            {% when 'title' %}
              <div class="title-row" {{ block.shopify_attributes }}>
                <h3 class="title">{{ product.title | escape }}</h3>
              </div>

        
            {% when 'price' %}
              <div class="price-container" {{ block.shopify_attributes }}>
                <div class="variant-visibility-area">
                  {%- for variant in product.variants -%}
                    <script type="text/template" data-variant-id="{{ variant.id }}">
                      {%- capture price_html -%}
                        <div class="price-area">
                          <div class="price h4-style {% if variant.compare_at_price > variant.price %}on-sale{% endif %}">
                            <span 
                              data-wpd-product-handle="{{ product.handle }}"
                              data-wpd-variant-id="{{ product.selected_or_first_available_variant.id }}"
                              data-wpd-variant-price="{{ product.selected_or_first_available_variant.price }}"
                              data-wpd-variant-compare-at-price="{{ product.selected_or_first_available_variant.compare_at_price }}"
                              data-wpd-product-collection-ids="{% assign wpdProductCollectionIds = product.collections | map:'id' %}{{ wpdProductCollectionIds | join:',' }}"
                              data-wpd-product-id="{{ product.id }}"
                              class="current-price theme-money">
                              {%- if settings.product_currency_code_enabled -%}
                                {{- variant.price | money_with_currency -}}
                              {%- else -%}
                                {{- variant.price | money -}}
                              {%- endif -%}
                            </span>
                        
                            {% if variant.compare_at_price > variant.price %}
                            <span class="data-wpd-hide was-price theme-money">{{ variant.compare_at_price | money }}</span>
                            {% endif %}
                          </div>

                          {% render 'unit-price', variant: variant %}
                        </div>
                      {%- endcapture -%}
                      {{- price_html -}}
                    </script>
                    {%- if current_variant and current_variant.id == variant.id -%}{{ price_html }}{%- endif -%}
                  {%- endfor -%}

                  <script type="text/template" data-variant-id="">
                    {%- capture price_html -%}
                      <div class="price-area">
                        {%- assign cheapest_variant = product.variants | sort: 'price' | first -%}
                        <div class="price h4-style {% if cheapest_variant.compare_at_price > cheapest_variant.price %}on-sale{% endif %}">
                          {% if product.price_varies %}
                            <span class="data-wpd-hide price__from">{{ 'products.listing.from' | t }}</span>
                          {% endif %}
                          <span 
                            data-wpd-product-handle="{{ product.handle }}"
                            data-wpd-variant-id="{{ product.selected_or_first_available_variant.id }}"
                            data-wpd-variant-price="{{ product.selected_or_first_available_variant.price }}"
                            data-wpd-variant-compare-at-price="{{ product.selected_or_first_available_variant.compare_at_price }}"
                            data-wpd-product-collection-ids="{% assign wpdProductCollectionIds = product.collections | map:'id' %}{{ wpdProductCollectionIds | join:',' }}"
                            data-wpd-product-id="{{ product.id }}"
                            class="current-price theme-money">
                            {%- if settings.product_currency_code_enabled -%}
                              {{ cheapest_variant.price | money_with_currency }}
                            {%- else -%}
                              {{ cheapest_variant.price | money }}
                            {%- endif -%}
                          </span>
                          {% if cheapest_variant.compare_at_price > cheapest_variant.price %}
                            <span class="data-wpd-hide was-price theme-money">{{ cheapest_variant.compare_at_price | money }}</span>
                          {% endif %}

                          {% render 'unit-price', variant: cheapest_variant %}
                        </div>
                      </div>
                    {%- endcapture -%}
                    {{- price_html -}}
                  </script>

                  {% if current_variant == false %}
                    {{- price_html -}}
                  {% endif %}
                </div>

                <div class="price-descriptors">
                  {%- form 'product', product, id: product_form_installments_id -%}
                    <input type="hidden" name="id" value="{% if current_variant %}{{ current_variant.id }}{% endif %}">
                    {{ form | payment_terms }}
                  {%- endform -%}

                  {%- if block.settings.show_tax_and_shipping -%}
                    {%- if cart.taxes_included or shop.shipping_policy.body != blank -%}
                      <div class="product-policies">
                        {%- if cart.taxes_included -%}
                          {{ 'products.product.include_taxes' | t }}
                        {%- endif -%}
                        {%- if shop.shipping_policy.body != blank -%}
                          {{ 'products.product.shipping_policy_html' | t: link: shop.shipping_policy.url }}
                        {%- endif -%}
                      </div>
                    {%- endif -%}
                  {%- endif -%}

                  {% if section.settings.inventory_transfers_enable %}
                    <div class="product-inventory-transfer {% unless current_variant.incoming %}product-inventory-transfer--none{% endunless %}">
                      {%- if current_variant.incoming -%}
                        {%- if current_variant.next_incoming_date -%}
                          {%- assign date = current_variant.next_incoming_date | date: format: 'date' -%}
                          {%- if current_variant.available -%}
                            {{ 'products.transfers.will_not_ship_until' | t: date: date }}
                          {%- else -%}
                            {{ 'products.transfers.will_be_in_stock_after' | t: date: date }}
                          {%- endif -%}
                        {%- else -%}
                          {{ 'products.transfers.waiting_for_stock' | t }}
                        {%- endif -%}
                      {%- endif -%}
                    </div>
                  {% endif %}
                </div>
                {%- if block.settings.enable_product_reviews_by_price and product.metafields.reviews.rating_count != blank -%}
                  {%- assign rating_count = product.metafields.reviews.rating_count | plus: 0 -%}
                  {%- if rating_count > 0 -%}
                    <div class="theme-product-reviews">
                      <a href="{{ product.url }}#shopify-product-reviews">
                        {% render 'rating', rating_value: product.metafields.reviews.rating.value %}
                        <span class="cc-rating-custom-caption">
                          {{ rating_count }} {{ 'products.product.reviews_link' | t: count: rating_count | downcase }}
                        </span>
                      </a>
                    </div>
                  {%- endif -%}
                {%- endif -%}
              </div>

                  <div class="postpay-widget"
                        data-type="product"
                        style="font-size:.95em;"
                        data-amount="{{ product.price }}"
                        data-currency="{{ shop.currency }}">
                  </div>


       
            {% when 'buy_buttons' %}
              {% capture upsells_html %}
                {% if product.metafields.custom.upsells_note.value %}
                  <span class="pdp-upsells-note">{{ product.metafields.custom.upsells_note.value }}</span>
                {% endif %}


                {% if product.metafields.custom.upsell_products_2.value != blank %}
                  <div class="upsell-row">
                    <div class="add-light-title label">
                      {{ product.metafields.custom.upsell_products_2_label.value | default: 'Goes well with' }}
                    </div>
                    <div class="upsell-select upsell2-select">
                      <div id="current-option-2" class="current-option option-value upsell2" data-value="">
                        <div class="current-option-img-wrapper">
                          <img
                            class="upsell-img current-option-img upsell2"
                            src="path_to_default_image.jpg"
                            alt="Default Option Image"
                          >
                        </div>
                        <div id="upsell-detail-2">UpsellProduct 2</div>
                      </div>
                      <div class="upsell-dropdown">
                        <ul id="add-light-2" class="add-item">
                          {% for listproduct in product.metafields.custom.upsell_products_2.value %}
                            {% assign variant = listproduct.selected_or_first_available_variant %}
                            {% if variant.available %}
                              <li
                                class="option_value upsell2"
                                data-value="yes"
                                data-ajax-add-to-cart="true"
                                data-item-id="{{ listproduct.selected_or_first_available_variant.id }}"
                                data-item-price="{{ listproduct.selected_or_first_available_variant.price }}"
                                data-bulb-qty="{{ product.metafields.custom.upsell_products_2_quantity.value }}"
                                data-add-to-cart-text="Add to Cart"
                              >
                                <div class="upsell-img">
                                  <img src="{{ listproduct.featured_image | img_url:'100x' }}">
                                </div>
                                {% assign upsell_quantity_2 = product.metafields.custom.upsell_products_2_quantity.value
                                  | default: 1
                                %}
                                {% assign total_price_2 = listproduct.selected_or_first_available_variant.price
                                  | times: upsell_quantity_2
                                %}
                                <div class="product_title">
                                  Yes. {{ listproduct.title }} (+{{ total_price_2 | money_with_currency }})
                                </div>
                              </li>
                            {% endif %}
                          {% endfor %}
                          <li class="option_value upsell2" data-value="no">
                            <div class="upsell-img none-img">
                              <img class="no-image" src="{{'no-img.png'| asset_url }} ">
                            </div>
                            <div>No</div>
                          </li>
                        </ul>
                      </div>
                    </div>
                  </div>
                {% endif %}
              
                {% if product.metafields.custom.upsell_products.value != blank %}
                  <div class="upsell-row">
                    <div class="add-light-title label">
                      {{
                        product.metafields.custom.upsell_products_label.value
                        | default: 'Include Complementaries?'
                      }}
                    </div>
                    <div class="upsell-select upsell1-select">
                      <div id="current-option-1" class="current-option option-value upsell1" data-value="">
                        <div class="current-option-img-wrapper">
                          <img
                            class="upsell-img current-option-img upsell1"
                            src="path_to_default_image.jpg"
                            alt="Default Option Image"
                          >
                        </div>
                        <div id="upsell-detail-1">UpsellProduct</div>
                      </div>
                      <div class="upsell-dropdown">
                        <ul id="add-light-1" class="add-item">
                          {% for listproduct in product.metafields.custom.upsell_products.value %}
                            {% assign variant = listproduct.selected_or_first_available_variant %}
                            {% if variant.available %}
                              <li
                                class="option_value upsell1"
                                data-value="yes"
                                data-ajax-add-to-cart="true"
                                data-item-id="{{ listproduct.selected_or_first_available_variant.id }}"
                                data-item-price="{{ listproduct.selected_or_first_available_variant.price }}"
                                data-bulb-qty="{{ product.metafields.custom.upsell_product_quantity.value }}"
                                data-add-to-cart-text="Add to Cart"
                              >
                                <div class="upsell-img">
                                  <img src="{{ listproduct.featured_image | img_url:'100x' }}">
                                </div>
                                {% assign upsell_quantity = product.metafields.custom.upsell_product_quantity.value
                                  | default: 1
                                %}
                                {% assign total_price = listproduct.selected_or_first_available_variant.price
                                  | times: upsell_quantity
                                %}
                                {% comment %} {{ total_price | money }} {% endcomment %}
                                <div class="product_title">
                                  Yes. {{ listproduct.title }} (+{{ total_price | money_with_currency }})
                                </div>
                              </li>
                            {% endif %}
                          {% endfor %}
                          <li class="option_value upsell1" data-value="no">
                            <div class="upsell-img none-img">
                              <img class="no-image" src="{{'no-img.png'| asset_url }} ">
                            </div>
                            <div>No</div>
                          </li>
                        </ul>
                      </div>
                    </div>
                  </div>
                {% endif %}
              {% endcapture %}
              
              {%- assign product_form_present = true -%}
              <div class="buy-buttons-row" {{ block.shopify_attributes }}>
                {% form 'product', product, id: product_form_id, class: 'form product-purchase-form', data-product-id: product.id %}
                  {{- original_select -}}

                  {% if product.available %}
                    {%- liquid
                      assign enable_dynamic_payment_button = false
                      if block.settings.enable_payment_button and product.selling_plan_groups == empty
                        unless product.template_suffix contains 'preorder'
                          assign enable_dynamic_payment_button = true
                        endunless
                      endif
                    -%}
                    <div class="quantity-submit-row input-row {% if enable_dynamic_payment_button %}has-spb{% endif %}">
                      {% if block.settings.show_quantity_selector %}
                        <label class="label" for="quantity">{{ 'products.product.quantity' | t }}</label>
                        <div class="quantity-wrapper">
                          <a href="#" data-quantity="down">{% render 'svg-minus' %}</a>
                          <input aria-label="{{ 'products.product.quantity' | t }}" id="quantity" type="number" name="quantity" value="1" />
                          <a href="#" data-quantity="up">{% render 'svg-plus' %}</a>
                        </div>
                      {% endif %}



                      <!-- old unused code for backup start -->
                      {% if false and product.metafields.custom.upsell_products.value != blank %}
                      <div class="upsell-row">
                        
                        <style>
                          .upsell-row {margin-top: 1rem;}
                          .upsell-row li {
                            list-style-type: none;
                          }
                          .upsell-select:after {
                              border-bottom: 2px solid #999;
                              border-right: 2px solid #999;
                              content: ""; display: block; height: 5px;margin-top: -4px;pointer-events: none;
                              position: absolute;right: 12px; top: 50%;transform-origin: 66% 66%;
                              transform: rotate(45deg);transition: all .15s ease-in-out;width: 5px;
                          }
                          .upsell-select.open:after {
                              transform: rotate(-135deg);
                          }
                          .upsell-dropdown{
                            width: 100%;position: absolute;opacity: 0; background: #fff; visibility: hidden;transform: scale(0.75) translateY(19px); transition: all .2s cubic-bezier(0.5, 0, 0, 1.25), opacity .15s ease-out;
                            box-shadow: 0 0 0 1px rgba(68,68,68,.11);margin-top: 4px;border-radius: 5px; z-index: 1;}
                          .upsell-select{position: relative;}
                          .option_value, .option-value{font-size: 14px;}
                          .Bulbselected{color:#000;}
                          .Bulbselected, .option_value:hover, .option-value:hover {background: #f6f6f6;}
                          .upsell-select.open .upsell-dropdown { opacity: 1;visibility: visible;transform: scale(1) translateY(0);}
                          .current-option{cursor: pointer;display: flex; align-items: center; gap: 1rem;padding: .5rem 28px .5rem 18px; border: solid 1px #e8e8e8;background: #fff; border-radius: 5px; }
                          .upsell-img{width: 2.6rem; height: auto;}
                          .option_value{display: flex; align-items: center; gap: 1rem;padding: .5rem 30px .5rem 18px;cursor: pointer;}
                          .add-item{margin: 0;}
                          .none-img{display: flex;align-items: center;justify-content: center;height: 3.45rem;}
                          .no-image{width: 24px !important;height: 24px !important;}
                          .current-option .no-small-img{width: 25px;height: 25px !important;}
                          .current-option-img-wrapper{width: 2.6rem;height: auto;display: flex; align-items: center;justify-content: center}
                          .current-option-img-wrapper img{max-width: 100%;height: 100%;}
                          .current-option .small-img{width: 25px;height: 25px !important;}
                          .upsell-dropdown .upsell-img img{width: 3rem; height: 100%;display: block;}
                          .current-option .small-img-wrapper{height: 3.45rem;}
                          .add-light-title{margin-bottom: 5px;}

                        </style>
                        <div class="add-light-title">Include required bulbs?</div>
                        <div class="upsell-select">
                          <div id="current-option" class="current-option option-value" data-value=""> 
                            <div class="current-option-img-wrapper"> <img class="upsell-img current-option-img" src="path_to_default_image.jpg" alt="Default Option Image"> </div>
                            <div id="upsell-detail">UpsellProduct</div> 
                          </div>
                          <div class="upsell-dropdown">
                            <ul id="add-light" class="add-item" >
                              {% for listproduct in product.metafields.custom.upsell_products.value %}
                                 {% assign variant = listproduct.selected_or_first_available_variant %}
                                {% if variant.available %}
                                <li class="option_value" data-value="yes" data-ajax-add-to-cart="true" data-item-id="{{ listproduct.selected_or_first_available_variant.id }}" data-item-price="{{ listproduct.selected_or_first_available_variant.price }}" data-bulb-qty="{{ product.metafields.custom.upsell_product_quantity.value }}" data-add-to-cart-text="Add to Cart">
                                <div class="upsell-img"><img src="{{ listproduct.featured_image | img_url:'100x' }}"></div>
                                  {% assign upsell_quantity = product.metafields.custom.upsell_product_quantity.value | default: 1 %}
                                  {% assign total_price = listproduct.selected_or_first_available_variant.price | times: upsell_quantity %}
                                 {% comment %} {{ total_price | money }} {% endcomment %}
                                <div class="product_title" > Yes. {{ listproduct.title }} (+{{ total_price | money_with_currency }}) </div>
                                </li>

                                {% endif %}
                            {% endfor %}
                            <li class="option_value" data-value ="no"><div class="upsell-img none-img"><img class="no-image" src="{{'no-img.png'| asset_url }} "></div> <div>No</div> </li>
                            </ul>
                          </div>
                        </div>
                      </div>
                      {% endif %}
                      <!-- old unused code for backup end -->

                      {{ upsells_html }} 
                      
                    <div class="quantity-submit-row__submit input-row">
                    <div class="js-form-error lightly-spaced-row" role="alert" hidden></div>

                    {%- assign selected_variant = product.selected_or_first_available_variant -%}
                    {% assign disable_button = false %}
                    {% assign button_text = 'Add To Cart' %}

                    {%- if selected_variant == blank -%}
                      {% assign disable_button = true %}
                      {% assign button_text = 'Sold Out' %}
                    {%- elsif selected_variant == blank or selected_variant.inventory_quantity <= 0 -%}
                      {% assign disable_button = true %}
                      {% assign button_text = 'Pre-order' %}
                    {%- endif -%}

                    {% comment %} <button
                      class="btn add-to-cart"
                      type="submit"
                      name="add"
                      data-add-to-cart-text="{{ button_text | escape }}"
                      {% if disable_button %}disabled{% endif %}
                    >
                      {{ button_text }}
                    </button> {% endcomment %}
                  </div>


                      {% if enable_dynamic_payment_button %}
                        <script class="dynamic-payment-button-template" type="text/template">
                          {{ form | payment_button }}
                        </script>
                      {% endif %}

                      {% if block.settings.show_backorder_text == true %}
                        {% render 'backorder', product: product, variant: current_variant %}
                      {% endif %}
                    </div>

                    {%- unless block.settings.show_pickup_availability == false -%}
                      {% render 'store-availability', product: product, current_variant: current_variant %}
                    {%- endunless -%}

                  {% else %}
                     {{ upsells_html }}
                    <div class="quantity-submit-row input-row">
                      <div class="quantity-submit-row__submit">
                        <button class="button sold-sticky-button  button--sold-out" type="submit">
                          {{- 'products.variant.no_stock' | t -}}
                        </button>
                      </div>
                    </div>
                  {% endif %}
                {% endform %}
                <div id='wcp_vd_table'></div>
              </div>

                  {% comment %} {% when 'estimated_delivery' %}
              {% assign dubai_dispatch_time = product.metafields.custom.dispatch_time_for_dubai.value %}
              {% assign all_other_emirates_dispatch_time = product.metafields.custom.dispatch_time_for_all_other_emirates.value %}
              {% assign gcc_dispatch_time = product.metafields.custom.dispatch_time_for_gcc.value %}

              {% assign dubai_delivery_time = product.metafields.custom.delivery_time_for_dubai.value %}
              {% assign all_other_emirates_delivery_time = product.metafields.custom.delivery_time_for_all_other_emirates.value %}
              {% assign saudi_delivery_time = product.metafields.custom.delivery_time_for_saudi_oman_kuwait_bahrain_qatar.value %}

              {% if dubai_delivery_time or all_other_emirates_delivery_time or saudi_delivery_time %}
              

                {%comment %}
                {% if product.metafields.custom.show_contact_sale %}
                <div class="meta_popup_text">
                  <span id="contact-sales-trigger" class="info_text">Contact our sales</span>
                  <span class="info_icon">
                    <svg xmlns="http://www.w3.org/2000/svg" shape-rendering="geometricPrecision" text-rendering="geometricPrecision" image-rendering="optimizeQuality" fill-rule="evenodd" clip-rule="evenodd" viewBox="0 0 512 512" style="&#10;    fill: #937e6c;&#10;"><path fill-rule="nonzero" d="M256 0c70.69 0 134.69 28.66 181.02 74.98C483.34 121.3 512 185.31 512 256c0 70.69-28.66 134.7-74.98 181.02C390.69 483.34 326.69 512 256 512c-70.69 0-134.69-28.66-181.02-74.98C28.66 390.69 0 326.69 0 256c0-70.69 28.66-134.69 74.98-181.02C121.31 28.66 185.31 0 256 0zm-9.96 161.03c0-4.28.76-8.26 2.27-11.91 1.5-3.63 3.77-6.94 6.79-9.91 3-2.95 6.29-5.2 9.84-6.7 3.57-1.5 7.41-2.28 11.52-2.28 4.12 0 7.96.78 11.49 2.27 3.54 1.51 6.78 3.76 9.75 6.73 2.95 2.97 5.16 6.26 6.64 9.91 1.49 3.63 2.22 7.61 2.22 11.89 0 4.17-.73 8.08-2.21 11.69-1.48 3.6-3.68 6.94-6.65 9.97-2.94 3.03-6.18 5.32-9.72 6.84-3.54 1.51-7.38 2.29-11.52 2.29-4.22 0-8.14-.76-11.75-2.26-3.58-1.51-6.86-3.79-9.83-6.79-2.94-3.02-5.16-6.34-6.63-9.97-1.48-3.62-2.21-7.54-2.21-11.77zm13.4 178.16c-1.11 3.97-3.35 11.76 3.3 11.76 1.44 0 3.27-.81 5.46-2.4 2.37-1.71 5.09-4.31 8.13-7.75 3.09-3.5 6.32-7.65 9.67-12.42 3.33-4.76 6.84-10.22 10.49-16.31.37-.65 1.23-.87 1.89-.48l12.36 9.18c.6.43.73 1.25.35 1.86-5.69 9.88-11.44 18.51-17.26 25.88-5.85 7.41-11.79 13.57-17.8 18.43l-.1.06c-6.02 4.88-12.19 8.55-18.51 11.01-17.58 6.81-45.36 5.7-53.32-14.83-5.02-12.96-.9-27.69 3.06-40.37l19.96-60.44c1.28-4.58 2.89-9.62 3.47-14.33.97-7.87-2.49-12.96-11.06-12.96h-17.45c-.76 0-1.38-.62-1.38-1.38l.08-.48 4.58-16.68c.16-.62.73-1.04 1.35-1.02l89.12-2.79c.76-.03 1.41.57 1.44 1.33l-.07.43-37.76 124.7zm158.3-244.93c-41.39-41.39-98.58-67-161.74-67-63.16 0-120.35 25.61-161.74 67-41.39 41.39-67 98.58-67 161.74 0 63.16 25.61 120.35 67 161.74 41.39 41.39 98.58 67 161.74 67 63.16 0 120.35-25.61 161.74-67 41.39-41.39 67-98.58 67-161.74 0-63.16-25.61-120.35-67-161.74z"/></svg>
                    <span class="tooltip_text">Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book.</span>
                  </span>   
                </div>
                
                {% endif %}
                 {% endcomment %}
              {% endif %} {% endcomment %}

              {% comment %} <script>

               customElements.define(
                'abz-estimated-delivery',
                class extends HTMLElement {
                  constructor() {
                    super();
                  }

                  connectedCallback() {
                    const elements = this.querySelectorAll('[data-dispatch-time][data-delivery-time]');
                    elements.forEach((el) => {
                      const dispatchTime = parseInt(el.getAttribute('data-dispatch-time'), 10);
                      const deliveryTime = parseInt(el.getAttribute('data-delivery-time'), 10);

                      if (isNaN(dispatchTime) || isNaN(deliveryTime)) {
                        el.textContent = '';
                        return;
                      }

                      let now = new Date();
                      const cutoffHour = 9;

                      // If after 9 a.m., move to next day
                      if (now.getHours() >= cutoffHour) {
                        now.setDate(now.getDate() + 1);
                      }

                      // Skip Sundays
                      if (now.getDay() === 0) {
                        now.setDate(now.getDate() + 1);
                      }

                      const fromDate = this.addBusinessDays(now, dispatchTime);
                      const toDate = this.addBusinessDays(fromDate, deliveryTime);

                      const formattedRange = this.formatDateRange(fromDate, toDate);
                      el.textContent = formattedRange;
                    });
                  }

                  addBusinessDays(startDate, daysToAdd) {
                    const date = new Date(startDate);
                    let added = 0;
                    while (added < daysToAdd) {
                      date.setDate(date.getDate() + 1);
                      if (date.getDay() !== 0) { // Skip Sundays
                        added++;
                      }
                    }
                    return date;
                  }

                  formatDateRange(start, end) {
                    const format = (date) => {
                      const day = date.getDate();
                      const month = date.toLocaleString(undefined, { month: 'short' });
                      return `${day} ${month}`;
                    };
                    return `${format(start)}  ${format(end)}`;
                  }
                }
              );
              </script> {% endcomment %}


              <cc-fetched-content class="not-in-quickbuy" data-id="{{ block.id }}" data-url="{{ routes.product_recommendations_url }}?section_id={{ section.id }}&product_id={{ product.id }}&intent=complementary" contains-product-blocks {{ block.shopify_attributes }}>
                {%- if recommendations.performed and recommendations.products_count > 0 -%}
                  {%- liquid
                    if settings.prod_thumb_shape == 'portrait-23'
                      assign chosen_aspect_ratio = 0.67
                    elsif settings.prod_thumb_shape == 'portrait-45'
                      assign chosen_aspect_ratio = 0.8
                    elsif settings.prod_thumb_shape == 'square'
                      assign chosen_aspect_ratio = 1.0
                    elsif settings.prod_thumb_shape == 'landscape-54'
                      assign chosen_aspect_ratio = 1.25
                    elsif settings.prod_thumb_shape == 'landscape-32'
                      assign chosen_aspect_ratio = 1.50
                    elsif settings.prod_thumb_shape == 'tallest'
                      assign chosen_aspect_ratio = 99
                      for product in recommendations.products limit: block.settings.max_products
                        if product.featured_media.preview_image.aspect_ratio < chosen_aspect_ratio
                          assign chosen_aspect_ratio = product.featured_media.preview_image.aspect_ratio
                        endif
                      endfor
                    else
                      assign chosen_aspect_ratio = 0
                      for product in recommendations.products limit: block.settings.max_products
                        if product.featured_media.preview_image.aspect_ratio > chosen_aspect_ratio
                          assign chosen_aspect_ratio = product.featured_media.preview_image.aspect_ratio
                        endif
                      endfor
                    endif
                  -%}

                  <div class="lightly-spaced-row lightish-spaced-row-above not-in-quickbuy">
                    {% if block.settings.enable_carousel and recommendations.products_count > 2 and block.settings.max_products > 2 %}
                      <div class="collection-slider collection-slider--no-wide-gutter">
                        <div class="opposing-items opposing-items--valign-base very-lightly-spaced-row">
                          <div class="opposing-items__left label">{{ block.settings.block_heading | escape }}</div>
                          <div class="no-wrap">
                            <a class="prev ltr-icon inh-col" href="#">{% render 'svg-chevron-left' %}</a>
                            <a class="next ltr-icon inh-col" href="#">{% render 'svg-chevron-right' %}</a>
                          </div>
                        </div>
                        <div class="collection-listing">
                          <div class="product-list product-list--image-shape-{{ settings.prod_thumb_shape }} carousel carousel--fixed-grid-mode carousel--per-row-2">
                            {%- liquid
                              for related_product in recommendations.products limit: block.settings.max_products
                                render 'product-block', product: related_product, manual_image_load: true, no_quick_buy: true, no_swiping: true, custom_aspect_ratio: chosen_aspect_ratio
                              endfor
                            -%}
                          </div>
                        </div>
                      </div>
                    {% else %}
                      <div class="very-lightly-spaced-row">
                        <div class="label">{{ block.settings.block_heading | escape }}</div>
                      </div>
                      <div class="fixed-layout fixed-layout--no-wide-gutter">
                        {%- liquid
                          for related_product in recommendations.products limit: block.settings.max_products
                            echo '<div class="column column--half">'
                            render 'product-block', product: related_product, manual_image_load: false, no_quick_buy: true, custom_aspect_ratio: chosen_aspect_ratio
                            echo '</div>'
                          endfor
                        -%}
                      </div>
                    {% endif %}
                  </div>
                {%- endif -%}
              </cc-fetched-content>

          {% endcase %}
        {% endfor %}

        {%- if product_form_present == false -%}
          <form class="product-purchase-form hidden" data-product-id="{{ product.id }}">
            {{- original_select -}}
          </form>
        {%- endif -%}

        <div class="lightish-spaced-row-above only-in-quickbuy">
          <a class="more" href="{{ product.url }}">
            <span class="beside-svg underline">{{ 'products.quick_buy.read_more' | t }}</span>
            <span class="icon--small icon-natcol ltr-icon">{% render 'svg-chevron-right' %}</span>
          </a>
        </div>
      </div>

      <script type="application/json" id="ProductJson-{{ product.id }}">
        {{- product | json -}}
      </script>
    </div>
  </div><!-- /.product-detail -->


</div>

<script>
document.addEventListener("DOMContentLoaded", function() {
  const stickyBar = document.querySelector(".stickey-addtocart-bar");
  const atcButton = document.querySelector(".add-to-cart");
  const pdpDetail = document.querySelector(".buy-buttons-row");

  if (stickyBar && pdpDetail && atcButton) {
    function toggleSticky() {
      const rect = pdpDetail.getBoundingClientRect();
      const isVisible = rect.top < window.innerHeight && rect.bottom > 0;

      if (!isVisible) {
        stickyBar.style.display = "block";
        atcButton.classList.add("sticky-active");
      } else {
        stickyBar.style.display = "none";
        atcButton.classList.remove("sticky-active");
      }
    }

    // Run on load + on scroll + resize
    toggleSticky();
    window.addEventListener("scroll", toggleSticky);
    window.addEventListener("resize", toggleSticky);
  }
});

</script>

<script>
document.addEventListener("DOMContentLoaded", function() {
  // find main form quantity
  const mainQty = document.querySelector(
    'input[name="quantity"]'
  );
  // find sticky bar quantity (make sure your sticky bar has a unique wrapper class!)
  const stickyQty = document.querySelector(
    '.stickey-addtocart-bar input[name="quantity"]'
  );

  if (!mainQty || !stickyQty) return;

  // --- main  sticky ---
  mainQty.addEventListener("input", () => {
    stickyQty.value = mainQty.value;
  });
  mainQty.addEventListener("change", () => {
    stickyQty.value = mainQty.value;
  });

  // --- (optional) sticky  main ---
  stickyQty.addEventListener("input", () => {
    mainQty.value = stickyQty.value;
    mainQty.dispatchEvent(new Event("change", { bubbles: true })); // trigger theme scripts
  });
  stickyQty.addEventListener("change", () => {
    mainQty.value = stickyQty.value;
    mainQty.dispatchEvent(new Event("change", { bubbles: true }));
  });

  // also capture clicks on +/- buttons
  document.addEventListener("click", (e) => {
    if (e.target.closest(".quantity-wrapper a")) {
      setTimeout(() => {
        stickyQty.value = mainQty.value; // update sticky after theme updates main
      }, 50);
    }
  });
});
</script>

<script>
customElements.define(
  'abz-estimated-delivery',
  class extends HTMLElement {
    constructor() {
      super();
    }

    connectedCallback() {
      const deliveryTimeDivs = this.querySelectorAll('[data-delivery-time]');
      const now = new Date();
      const cutoffHour = 9;

      const baseDate = new Date();
      if (now.getHours() >= cutoffHour) {
        baseDate.setDate(baseDate.getDate() + 1);
      }

      deliveryTimeDivs.forEach((div) => {
        const deliveryTime = parseInt(div.getAttribute('data-delivery-time'), 10);
        const label = div.closest('.estimated-delivery-card')
                        ?.querySelector('.estimated-delivery-label')
                        ?.textContent
                        ?.toLowerCase()
                        ?.trim() || '';

        if (isNaN(deliveryTime)) {
          div.textContent = '';
          return;
        }

        let bufferDays = 1;
        if (label.includes('dubai')) {
          bufferDays = 1;
        } else if (label.includes('all other emirates')) {
          bufferDays = 3;
        } else if (label.includes('gcc')) {
          bufferDays = 7;
        }

        let startDate, endDate;
        if (label.includes('dubai')) {
          startDate = this.addDaysSkippingSunday(new Date(baseDate), deliveryTime, true); 
          endDate = this.addDaysSkippingSunday(new Date(startDate), bufferDays, false);
        } else {
          startDate = this.addDaysSkippingSunday(new Date(baseDate), bufferDays, true);
          endDate = this.addDaysSkippingSunday(new Date(baseDate), deliveryTime, true);
        }

        const formatDate = (date) => {
          const day = date.getDate();
          const month = date.toLocaleString('default', { month: 'short' });
          return `${day} ${month}`;
        };
        const startStr = formatDate(startDate);
        const endStr = formatDate(endDate);
        div.textContent = `${startStr} - ${endStr}`;
      });
    }

    addDaysSkippingSunday(date, daysToAdd, includeToday = false) {
      const result = new Date(date);

      if (includeToday && result.getDay() !== 0) {
        daysToAdd--;
      }

      while (daysToAdd > 0) {
        result.setDate(result.getDate() + 1);
        if (result.getDay() !== 0) {
          daysToAdd--;
        }
      }

      return result;
    }
  }
);
const deliveryComponent = document.querySelector('abz-estimated-delivery');

document.querySelectorAll('.opt-label').forEach(label => {
label.addEventListener('click', () => {
  const dubaiDelivery = label.dataset.dubaiDeliveryTime;
  const emiratesDelivery = label.dataset.emiratesDeliveryTime;
  const saudiDelivery = label.dataset.saudiDeliveryTime;

const qty = Number(label.dataset.qty || label.getAttribute('qty') || 0);

  if (qty == 0) {
      if (deliveryComponent) deliveryComponent.style.display = 'none';
      return; // stop running the rest of the code
    } else {
      if (deliveryComponent) deliveryComponent.style.display = ''; // show it again
    }

  if (dubaiDelivery && emiratesDelivery && saudiDelivery) {
  const updateCard = (selector, delivery) => {
    const el = deliveryComponent.querySelector(selector);
    if (el) {
      el.setAttribute('data-delivery-time', delivery || 0);
    }
  };

  updateCard('.estimated-delivery-card:nth-child(1) .estimated-delivery-date', dubaiDelivery);
  updateCard('.estimated-delivery-card:nth-child(2) .estimated-delivery-date', emiratesDelivery);
  updateCard('.estimated-delivery-card:nth-child(3) .estimated-delivery-date', saudiDelivery);

  deliveryComponent.connectedCallback();
}
});
});
</script>
<script>
{% comment %} document.addEventListener("DOMContentLoaded", function () {
  setTimeout(function () {
      var originalPriceEl = document.querySelector('.product-column-right .price-area .price .data-wpd-hide.was-price .etrans-money');
      console.log("originalPriceEl", originalPriceEl);
      var discountedPriceEl = document.querySelector('.product-column-right .price-area .price .current-price .etrans-money');
      console.log("discountedPriceEl", discountedPriceEl);
      
      if (originalPriceEl && discountedPriceEl) {
          var originalPrice = parseFloat(originalPriceEl.textContent.replace(/[^\d.-]/g, ''));
          var discountedPrice = parseFloat(discountedPriceEl.textContent.replace(/[^\d.-]/g, ''));

          if (!isNaN(originalPrice) && !isNaN(discountedPrice)) {
              var amountSaved = (originalPrice - discountedPrice).toFixed(2);
              console.log("amountSaved", amountSaved);
              var percentSaved = Math.round((amountSaved / originalPrice) * 100);
              console.log("percentSaved", percentSaved);

              if (percentSaved > 0) {
                  var badgeMessage = `-${percentSaved}%`;
                  var badgeColor = '#917A63'; 

                  var badge = document.createElement('div');
                  badge.className = 'designer-discount-badge';
                  badge.style.backgroundColor = badgeColor;
                  badge.style.color = '#fff';
                  badge.style.padding = '5px 10px';
                  badge.style.margin = '0 10px';
                  badge.style.fontWeight = 'normal';
                  badge.style.borderRadius = '5px';
                  badge.innerText = badgeMessage;

                  var productImageContainer = document.querySelector('.price-area .price');
                  if (productImageContainer) {
                      productImageContainer.style.position = 'relative';
                      productImageContainer.appendChild(badge);
                  }
              }
          }
      }
  }, 3000);
}); {% endcomment %}
</script>
<script>
document.addEventListener("DOMContentLoaded", function () {
setTimeout(function () {
    applyDiscountBadge()
}, 1000);
});

function applyDiscountBadge() {
    setTimeout(function () {
        var originalPriceEl = document.querySelector('.product-column-right .price-area .price .data-wpd-hide.was-price .etrans-money');
    console.log("originalPriceEl", originalPriceEl);
    var discountedPriceEl = document.querySelector('.product-column-right .price-area .price .current-price .etrans-money');
    console.log("discountedPriceEl", discountedPriceEl);
    
    if (originalPriceEl && discountedPriceEl) {
        var originalPrice = parseFloat(originalPriceEl.textContent.replace(/[^\d.-]/g, ''));
        var discountedPrice = parseFloat(discountedPriceEl.textContent.replace(/[^\d.-]/g, ''));

        if (!isNaN(originalPrice) && !isNaN(discountedPrice)) {
            var amountSaved = (originalPrice - discountedPrice).toFixed(2);
            console.log("amountSaved", amountSaved);
            var percentSaved = Math.round((amountSaved / originalPrice) * 100);
            console.log("percentSaved", percentSaved);

            if (percentSaved > 0) {
                var badgeMessage = `-${percentSaved}%`;
                var badgeColor = '#917A63'; 

                var badge = document.createElement('div');
                badge.className = 'designer-discount-badge';
                badge.style.backgroundColor = badgeColor;
                badge.style.color = '#fff';
                badge.style.padding = '5px 10px';
                badge.style.margin = '0 10px 5px';
                badge.style.fontWeight = 'normal';
                badge.style.borderRadius = '5px';
                badge.innerText = badgeMessage;

                var productImageContainer = document.querySelector('.price-area .price');
                if (productImageContainer) {
                    productImageContainer.style.position = 'relative';
                    productImageContainer.appendChild(badge);
                }
            }
        }
    }
    }, 2000);
}
document.querySelectorAll('.opt-label').forEach(function (label) {
        label.addEventListener('click', function () {
            applyDiscountBadge();
        });
    });
</script>

{% schema %}
  {
    "name": "Product pages",
    "class": "section-main-product page-section-spacing page-section-spacing--no-top-mobile",
    "settings": [
      {
        "type": "checkbox",
        "id": "show_breadcrumbs",
        "label": "Show breadcrumbs",
        "default": true
      },
      {
        "type": "checkbox",
        "id": "show_location_underneath",
        "label": "Show description below media",
        "default": false
      },
      {
        "type": "checkbox",
        "id": "inventory_transfers_enable",
        "label": "Show inventory transfer notice",
        "info": "Shows under price. Learn how to create inventory transfers [here](https://help.shopify.com/en/manual/products/inventory/transfers/create-transfer)",
        "default": true
      },
      {
        "type": "checkbox",
        "id": "enable_sticky_columns",
        "label": "Enable stick on scroll",
        "default": false
      },
      {
        "type": "header",
        "content": "Media"
      },
      {
        "type": "paragraph",
        "content": "Learn more about [media types](https://help.shopify.com/en/manual/products/product-media)"
      },
      {
        "type": "select",
        "id": "gallery_size",
        "label": "Size",
        "options": [
          {
            "value": "small",
            "label": "Small"
          },
          {
            "value": "medium",
            "label": "Medium"
          },
          {
            "value": "large",
            "label": "Large"
          }
        ],
        "default": "medium"
      },
      {
        "type": "select",
        "id": "gallery_layout",
        "label": "Layout",
        "options": [
          {
            "value": "carousel-beside",
            "label": "Carousel - thumbnails left"
          },
          {
            "value": "carousel-under",
            "label": "Carousel - thumbnails below"
          },
          {
            "value": "columns-1",
            "label": "One column"
          },
          {
            "value": "columns-2",
            "label": "Two column"
          },
          {
            "value": "collage-1",
            "label": "Collage - style 1"
          },
          {
            "value": "collage-2",
            "label": "Collage - style 2"
          }
        ],
        "default": "carousel-under"
      },
      {
        "type": "checkbox",
        "id": "enable_zoom",
        "label": "Enable image zoom",
        "default": true
      },
      {
        "type": "checkbox",
        "id": "enable_video_looping",
        "label": "Enable video looping",
        "default": false
      },
      {
        "type": "header",
        "content": "Media grouping"
      },
      {
        "type": "checkbox",
        "id": "enable_var_img_grouping",
        "label": "Show media associated with the selected variant",
        "info": "Other variants' media will be hidden",
        "default": false
      },
      {
        "type": "text",
        "id": "var_img_grouping_option",
        "label": "Option name",
        "info": "The name of the option to group media by.",
        "default": "Color,Colour,Couleur,Farbe"
      },
      {
        "type": "paragraph",
        "content": "If your store displays multiple languages, include all translations separated by a comma, e.g. Color,Couleur,Farbe"
      },
      {
        "type": "paragraph",
        "content": "Arrange product media by this option (all 'red' media together, then all 'blue' media together, for example). The first media in each group should be assigned to a variant. [Read more](https://cleancanvas.co.uk/support/general/grouped-variant-images)"
      }
    ],
    "blocks": [
      {
        "type": "@app"
      },
      {
        "type": "title",
        "name": "Title",
        "limit": 1
      },
      {
        "type": "price",
        "name": "Price",
        "limit": 1,
        "settings": [
          {
            "type": "checkbox",
            "id": "show_tax_and_shipping",
            "label": "Show tax status and shipping policy link",
            "default": false
          },
          {
            "type": "checkbox",
            "label": "Show reviews rating",
            "id": "enable_product_reviews_by_price",
            "info": "Add reviews by installing the [Shopify Product Reviews app](https:\/\/apps.shopify.com\/product-reviews)",
            "default": true
          }
        ]
      },
      {
        "type": "description",
        "name": "Description",
        "limit": 1,
        "settings": [
          {
            "type": "checkbox",
            "id": "show_in_tab",
            "label": "Show in tab",
            "default": false
          },
          {
            "type": "checkbox",
            "id": "open_tab",
            "label": "Open tab",
            "default": false
          },
          {
            "type": "select",
            "id": "icon",
            "label": "Icon",
            "default": "",
            "options": [
              {
                "value": "",
                "label": "No icon"
              },
              {
                "value": "award",
                "label": "Award"
              },
              {
                "value": "box",
                "label": "Box"
              },
              {
                "value": "briefcase",
                "label": "Briefcase"
              },
              {
                "value": "calendar",
                "label": "Calendar"
              },
              {
                "value": "chat_bubble",
                "label": "Chat bubble"
              },
              {
                "value": "check_mark",
                "label": "Check mark"
              },
              {
                "value": "check_mark_in_circle",
                "label": "Check mark in circle"
              },
              {
                "value": "clock",
                "label": "Clock"
              },
              {
                "value": "credit_card",
                "label": "Credit card"
              },
              {
                "value": "dollar_sign",
                "label": "Dollar sign"
              },
              {
                "value": "dryer",
                "label": "Dryer"
              },
              {
                "value": "eye",
                "label": "Eye"
              },
              {
                "value": "feather",
                "label": "Feather"
              },
              {
                "value": "gift",
                "label": "Gift"
              },
              {
                "value": "heart",
                "label": "Heart"
              },
              {
                "value": "iron",
                "label": "Iron"
              },
              {
                "value": "leaf",
                "label": "Leaf"
              },
              {
                "value": "leather",
                "label": "Leather"
              },
              {
                "value": "lock",
                "label": "Lock"
              },
              {
                "value": "map_pin",
                "label": "Map pin"
              },
              {
                "value": "pants",
                "label": "Pants"
              },
              {
                "value": "percent",
                "label": "Percent"
              },
              {
                "value": "plane",
                "label": "Plane"
              },
              {
                "value": "price_tag",
                "label": "Price tag"
              },
              {
                "value": "question_mark",
                "label": "Question mark"
              },
              {
                "value": "return",
                "label": "Return"
              },
              {
                "value": "ruler",
                "label": "Ruler"
              },
              {
                "value": "scissors",
                "label": "Scissors"
              },
              {
                "value": "shirt",
                "label": "Shirt"
              },
              {
                "value": "shoe",
                "label": "Shoe"
              },
              {
                "value": "silhouette",
                "label": "Silhouette"
              },
              {
                "value": "star",
                "label": "Star"
              },
              {
                "value": "truck",
                "label": "Truck"
              },
              {
                "value": "washing",
                "label": "Washing"
              }
            ]
          },
          {
            "type": "checkbox",
            "id": "show_in_quickbuy",
            "label": "Show in quick buy",
            "default": false
          }
        ]
      },
      {
        "type": "vendor",
        "name": "Vendor",
        "limit": 1
      },
      {
        "type": "sku",
        "name": "SKU",
        "limit": 1
      },
      {
        "type": "variant_picker",
        "name": "Variant picker",
        "settings": [
          {
            "type": "checkbox",
            "id": "show_single",
            "label": "Show for a single variant",
            "default": false
          },
          {
            "type": "checkbox",
            "id": "select_first_variant",
            "label": "Select first available variant",
            "default": true
          },
          {
            "type": "radio",
            "id": "variant_style",
            "label": "Variant style",
            "options": [
              {
                "value": "listed",
                "label": "Box with label"
              },
              {
                "value": "dropdown",
                "label": "Dropdown"
              }
            ],
            "default": "listed"
          },
          {
            "type": "checkbox",
            "id": "disable_unavailable_variants",
            "label": "Show availability in selectors",
            "info": "When an option is selected, options below it are updated to show their availability",
            "default": true
          },
          {
            "type": "header",
            "content": "Size chart"
          },
          {
            "type": "checkbox",
            "id": "show_size_chart",
            "label": "Enable size chart",
            "default": false
          },
          {
            "type": "text",
            "id": "size_chart_variant",
            "label": "Option name",
            "info": "The label to show the link beside",
            "default": "Size"
          },
          {
            "type": "page",
            "id": "size_chart_page",
            "label": "Page containing size chart"
          }
        ],
        "limit": 1
      },
      {
        "type": "buy_buttons",
        "name": "Buy buttons",
        "limit": 1,
        "settings": [
          {
            "type": "checkbox",
            "id": "show_quantity_selector",
            "label": "Show quantity selector",
            "default": true
          },
          {
            "type": "checkbox",
            "id": "enable_payment_button",
            "label": "Show dynamic checkout button",
            "info": "Each customer will see their preferred payment method from those available on your store, such as PayPal or Apple Pay. [Learn more](https://help.shopify.com/manual/using-themes/change-the-layout/dynamic-checkout)",
            "default": true
          },
          {
            "type": "checkbox",
            "id": "show_backorder_text",
            "label": "Show backorder text",
            "default": true,
            "info": "Only shows for products which use Shopify inventory tracking and are available to purchase when out of stock."
          },
          {
            "type": "checkbox",
            "id": "show_pickup_availability",
            "label": "Show pickup availability",
            "default": true,
            "info": "Show customers where they can pick up the product. [Learn more](https://help.shopify.com/en/manual/shipping/setting-up-and-managing-your-shipping/local-methods/local-pickup)"
          }
        ]
      },
      {
      "type": "estimated_delivery",
      "name": "Estimated Delivery",
      "settings": [
        {
          "type": "text",
          "id": "estimated_delivery_title",
          "label": "Estimated Delivery Title",
          "default": "Estimated Delivery"
        },
        {
          "type": "image_picker",
          "id": "estimated_delivery_icon",
          "label": "Estimated Delivery Icon"
        },
        {
          "type": "text",
          "id": "dubai_delivery_dates_label",
          "label": "Dubai Delivery Dates Label",
          "default": "Dubai"
        },
        {
          "type": "text",
          "id": "all_other_emirates_delivery_dates_label",
          "label": "All other emirates delivery dates label",
          "default": "All other emirates"
        },
        {
          "type": "text",
          "id": "saudi_delivery_dates_label",
          "label": "Saudi Arabia, Oman, Kuwait, Bahrain, Qatar delivery dates label",
          "default": "Saudi Arabia, Oman, Kuwait, Bahrain, Qatar"
        }
      ]
    },
      {
        "type": "inventory_level",
        "name": "Inventory level",
        "settings": [
          {
            "type": "radio",
            "id": "show_inventory_notice",
            "label": "Show inventory notice",
            "options": [
              {
                "label": "Only when inventory low",
                "value": "low"
              },
              {
                "label": "Always",
                "value": "always"
              }
            ],
            "default": "low"
          },
          {
            "type": "select",
            "id": "show_inventory_count",
            "label": "Show count in inventory notice",
            "options": [
              {
                "label": "Never",
                "value": "never"
              },
              {
                "label": "Only when inventory low",
                "value": "low"
              },
              {
                "label": "Always",
                "value": "always"
              }
            ],
            "default": "low"
          },
          {
            "type": "range",
            "id": "inventory_threshold",
            "min": 1,
            "max": 100,
            "step": 1,
            "label": "Low inventory threshold",
            "default": 10
          },
          {
            "type": "checkbox",
            "id": "enable_box",
            "label": "Enable box style",
            "default": false
          },
          {
            "type": "checkbox",
            "id": "enable_pulse",
            "label": "Enable pulse",
            "default": true
          },
          {
            "type": "checkbox",
            "id": "show_in_quickbuy",
            "label": "Show in quick buy",
            "default": true
          }
        ]
      },
      {
        "type": "accordion",
        "name": "Collapsible tab",
        "settings": [
          {
            "type": "text",
            "id": "title",
            "label": "Heading",
            "default": "Collapsible tab"
          },
          {
            "type": "select",
            "id": "icon",
            "label": "Icon",
            "default": "",
            "options": [
              {
                "value": "",
                "label": "No icon"
              },
              {
                "value": "award",
                "label": "Award"
              },
              {
                "value": "box",
                "label": "Box"
              },
              {
                "value": "briefcase",
                "label": "Briefcase"
              },
              {
                "value": "calendar",
                "label": "Calendar"
              },
              {
                "value": "chat_bubble",
                "label": "Chat bubble"
              },
              {
                "value": "check_mark",
                "label": "Check mark"
              },
              {
                "value": "check_mark_in_circle",
                "label": "Check mark in circle"
              },
              {
                "value": "clock",
                "label": "Clock"
              },
              {
                "value": "credit_card",
                "label": "Credit card"
              },
              {
                "value": "dollar_sign",
                "label": "Dollar sign"
              },
              {
                "value": "dryer",
                "label": "Dryer"
              },
              {
                "value": "eye",
                "label": "Eye"
              },
              {
                "value": "feather",
                "label": "Feather"
              },
              {
                "value": "gift",
                "label": "Gift"
              },
              {
                "value": "heart",
                "label": "Heart"
              },
              {
                "value": "iron",
                "label": "Iron"
              },
              {
                "value": "leaf",
                "label": "Leaf"
              },
              {
                "value": "leather",
                "label": "Leather"
              },
              {
                "value": "lock",
                "label": "Lock"
              },
              {
                "value": "map_pin",
                "label": "Map pin"
              },
              {
                "value": "pants",
                "label": "Pants"
              },
              {
                "value": "percent",
                "label": "Percent"
              },
              {
                "value": "plane",
                "label": "Plane"
              },
              {
                "value": "price_tag",
                "label": "Price tag"
              },
              {
                "value": "question_mark",
                "label": "Question mark"
              },
              {
                "value": "return",
                "label": "Return"
              },
              {
                "value": "ruler",
                "label": "Ruler"
              },
              {
                "value": "scissors",
                "label": "Scissors"
              },
              {
                "value": "shirt",
                "label": "Shirt"
              },
              {
                "value": "shoe",
                "label": "Shoe"
              },
              {
                "value": "silhouette",
                "label": "Silhouette"
              },
              {
                "value": "star",
                "label": "Star"
              },
              {
                "value": "truck",
                "label": "Truck"
              },
              {
                "value": "washing",
                "label": "Washing"
              }
            ]
          },
          {
            "type": "richtext",
            "id": "content",
            "label": "Tab content",
            "default": "<p>Collapsible tab content</p>"
          },
          {
            "type": "page",
            "id": "page",
            "label": "Tab content from page"
          },
          {
            "type": "checkbox",
            "id": "open",
            "label": "Open",
            "default": false
          },
          {
            "type": "checkbox",
            "id": "show_in_quickbuy",
            "label": "Show in quick buy",
            "default": false
          }
        ]
      },
      {
        "type": "text",
        "name": "Text",
        "settings": [
          {
            "type": "text",
            "id": "text",
            "label": "Text",
            "default": "Text block"
          },
          {
            "type": "select",
            "id": "icon",
            "label": "Icon",
            "default": "",
            "options": [
              {
                "value": "",
                "label": "No icon"
              },
              {
                "value": "award",
                "label": "Award"
              },
              {
                "value": "box",
                "label": "Box"
              },
              {
                "value": "briefcase",
                "label": "Briefcase"
              },
              {
                "value": "calendar",
                "label": "Calendar"
              },
              {
                "value": "chat_bubble",
                "label": "Chat bubble"
              },
              {
                "value": "check_mark",
                "label": "Check mark"
              },
              {
                "value": "check_mark_in_circle",
                "label": "Check mark in circle"
              },
              {
                "value": "clock",
                "label": "Clock"
              },
              {
                "value": "credit_card",
                "label": "Credit card"
              },
              {
                "value": "dollar_sign",
                "label": "Dollar sign"
              },
              {
                "value": "dryer",
                "label": "Dryer"
              },
              {
                "value": "eye",
                "label": "Eye"
              },
              {
                "value": "feather",
                "label": "Feather"
              },
              {
                "value": "gift",
                "label": "Gift"
              },
              {
                "value": "heart",
                "label": "Heart"
              },
              {
                "value": "iron",
                "label": "Iron"
              },
              {
                "value": "leaf",
                "label": "Leaf"
              },
              {
                "value": "leather",
                "label": "Leather"
              },
              {
                "value": "lock",
                "label": "Lock"
              },
              {
                "value": "map_pin",
                "label": "Map pin"
              },
              {
                "value": "pants",
                "label": "Pants"
              },
              {
                "value": "percent",
                "label": "Percent"
              },
              {
                "value": "plane",
                "label": "Plane"
              },
              {
                "value": "price_tag",
                "label": "Price tag"
              },
              {
                "value": "question_mark",
                "label": "Question mark"
              },
              {
                "value": "return",
                "label": "Return"
              },
              {
                "value": "ruler",
                "label": "Ruler"
              },
              {
                "value": "scissors",
                "label": "Scissors"
              },
              {
                "value": "shirt",
                "label": "Shirt"
              },
              {
                "value": "shoe",
                "label": "Shoe"
              },
              {
                "value": "silhouette",
                "label": "Silhouette"
              },
              {
                "value": "star",
                "label": "Star"
              },
              {
                "value": "truck",
                "label": "Truck"
              },
              {
                "value": "washing",
                "label": "Washing"
              }
            ]
          },
          {
            "type": "image_picker",
            "id": "custom_icon",
            "label": "Custom icon"
          },
          {
            "type": "select",
            "id": "icon_size",
            "label": "Icon size",
            "default": "small",
            "options": [
              {
                "value": "small",
                "label": "Small"
              },
              {
                "value": "large",
                "label": "Large"
              }
            ]
          },
          {
            "type": "checkbox",
            "id": "enable_box",
            "label": "Enable box style",
            "default": false
          },
          {
            "type": "color",
            "id": "box_color",
            "label": "Box color",
            "info": "Suggestions: Blue #e5f3ff, Teal #e0f5f5, Green #e0f4d5, Yellow #fcf1cd, Red #fbeae5",
            "default": "#e0f4d5"
          },
          {
            "type": "checkbox",
            "id": "show_in_quickbuy",
            "label": "Show in quick buy",
            "default": false
          }
        ]
      },
      {
        "type": "richtext",
        "name": "Rich text",
        "settings": [
          {
            "type": "richtext",
            "id": "richtext",
            "label": "Rich text",
            "default": "<p>Rich text block</p>"
          },
          {
            "type": "select",
            "id": "icon",
            "label": "Icon",
            "default": "",
            "options": [
              {
                "value": "",
                "label": "No icon"
              },
              {
                "value": "award",
                "label": "Award"
              },
              {
                "value": "box",
                "label": "Box"
              },
              {
                "value": "briefcase",
                "label": "Briefcase"
              },
              {
                "value": "calendar",
                "label": "Calendar"
              },
              {
                "value": "chat_bubble",
                "label": "Chat bubble"
              },
              {
                "value": "check_mark",
                "label": "Check mark"
              },
              {
                "value": "check_mark_in_circle",
                "label": "Check mark in circle"
              },
              {
                "value": "clock",
                "label": "Clock"
              },
              {
                "value": "credit_card",
                "label": "Credit card"
              },
              {
                "value": "dollar_sign",
                "label": "Dollar sign"
              },
              {
                "value": "dryer",
                "label": "Dryer"
              },
              {
                "value": "eye",
                "label": "Eye"
              },
              {
                "value": "feather",
                "label": "Feather"
              },
              {
                "value": "gift",
                "label": "Gift"
              },
              {
                "value": "heart",
                "label": "Heart"
              },
              {
                "value": "iron",
                "label": "Iron"
              },
              {
                "value": "leaf",
                "label": "Leaf"
              },
              {
                "value": "leather",
                "label": "Leather"
              },
              {
                "value": "lock",
                "label": "Lock"
              },
              {
                "value": "map_pin",
                "label": "Map pin"
              },
              {
                "value": "pants",
                "label": "Pants"
              },
              {
                "value": "percent",
                "label": "Percent"
              },
              {
                "value": "plane",
                "label": "Plane"
              },
              {
                "value": "price_tag",
                "label": "Price tag"
              },
              {
                "value": "question_mark",
                "label": "Question mark"
              },
              {
                "value": "return",
                "label": "Return"
              },
              {
                "value": "ruler",
                "label": "Ruler"
              },
              {
                "value": "scissors",
                "label": "Scissors"
              },
              {
                "value": "shirt",
                "label": "Shirt"
              },
              {
                "value": "shoe",
                "label": "Shoe"
              },
              {
                "value": "silhouette",
                "label": "Silhouette"
              },
              {
                "value": "star",
                "label": "Star"
              },
              {
                "value": "truck",
                "label": "Truck"
              },
              {
                "value": "washing",
                "label": "Washing"
              }
            ]
          },
          {
            "type": "image_picker",
            "id": "custom_icon",
            "label": "Custom icon"
          },
          {
            "type": "select",
            "id": "icon_size",
            "label": "Icon size",
            "default": "small",
            "options": [
              {
                "value": "small",
                "label": "Small"
              },
              {
                "value": "large",
                "label": "Large"
              }
            ]
          },
          {
            "type": "checkbox",
            "id": "enable_box",
            "label": "Enable box style",
            "default": false
          },
          {
            "type": "color",
            "id": "box_color",
            "label": "Box color",
            "info": "Suggestions: Blue #e5f3ff, Teal #e0f5f5, Green #e0f4d5, Yellow #fcf1cd, Red #fbeae5",
            "default": "#e0f4d5"
          },
          {
            "type": "checkbox",
            "id": "show_in_quickbuy",
            "label": "Show in quick buy",
            "default": false
          }
        ]
      },
      {
        "type": "popup",
        "name": "Pop-up",
        "settings": [
          {
            "type": "text",
            "id": "text",
            "label": "Link text",
            "default": "Pop-up link text"
          },
          {
            "type": "select",
            "id": "style",
            "label": "Style",
            "default": "primary",
            "options": [
              {
                "label": "Button - primary",
                "value": "primary"
              },
              {
                "label": "Button - secondary",
                "value": "secondary"
              },
              {
                "label": "Link",
                "value": "link"
              }
            ]
          },
          {
            "type": "page",
            "id": "page",
            "label": "Page"
          },
          {
            "type": "checkbox",
            "id": "show_in_quickbuy",
            "label": "Show in quick buy",
            "default": false
          }
        ]
      },
      {
      "type": "popup_content",
      "name": "Popup Contact",
      "settings": [
        {
          "type": "text",
          "id": "Popup_title",
          "label": "Popup Title"
        },
        {
          "type": "richtext",
          "id": "popup_content",
          "label": "Popup Content"
        }
      ]
    },
      {
        "type": "link",
        "name": "Link",
        "settings": [
          {
            "type": "url",
            "id": "url",
            "label": "Link"
          },
          {
            "type": "checkbox",
            "id": "open_in_new_tab",
            "label": "Open link in new tab",
            "default": false
          },
          {
            "type": "text",
            "id": "text",
            "label": "Text",
            "default": "Link text"
          },
          {
            "type": "select",
            "id": "style",
            "label": "Style",
            "default": "primary",
            "options": [
              {
                "label": "Button - primary",
                "value": "primary"
              },
              {
                "label": "Button - secondary",
                "value": "secondary"
              },
              {
                "label": "Link",
                "value": "link"
              }
            ]
          },
          {
            "type": "checkbox",
            "id": "show_in_quickbuy",
            "label": "Show in quick buy",
            "default": false
          }
        ]
      },
      {
        "type": "image",
        "name": "Image",
        "settings": [
          {
            "type": "image_picker",
            "id": "image",
            "label": "Image"
          },
          {
            "type": "range",
            "id": "image_width",
            "min": 60,
            "max": 700,
            "step": 10,
            "unit": "px",
            "label": "Image width",
            "default": 700
          },
          {
            "type": "url",
            "id": "url",
            "label": "Link"
          },
          {
            "type": "checkbox",
            "id": "open_in_new_tab",
            "label": "Open link in new tab",
            "default": false
          },
          {
            "type": "checkbox",
            "id": "show_in_quickbuy",
            "label": "Show in quick buy",
            "default": false
          }
        ]
      },
      {
        "type": "custom_option",
        "name": "Custom option",
        "settings": [
          {
            "type": "text",
            "id": "label",
            "label": "Label",
            "info": "Required",
            "default": "Custom option"
          },
          {
            "type": "select",
            "id": "type",
            "label": "Type",
            "default": "text",
            "options": [
              {
                "label": "Text",
                "value": "text"
              },
              {
                "label": "Long text",
                "value": "textarea"
              },
              {
                "label": "Checkbox",
                "value": "checkbox"
              },
              {
                "label": "Multiple options",
                "value": "multiple"
              }
            ]
          },
          {
            "type": "header",
            "content": "Text"
          },
          {
            "type": "checkbox",
            "id": "text_required",
            "label": "Require text",
            "info": "Only works with 'Add to cart' button",
            "default": false
          },
          {
            "type": "header",
            "content": "Checkbox"
          },
          {
            "type": "text",
            "id": "checkbox_checked_value",
            "label": "Checked value",
            "default": "Yes"
          },
          {
            "type": "text",
            "id": "checkbox_unchecked_value",
            "label": "Unchecked value",
            "default": "No"
          },
          {
            "type": "header",
            "content": "Multiple options"
          },
          {
            "type": "select",
            "id": "multiple_style",
            "label": "Style",
            "default": "dropdown",
            "options": [
              {
                "label": "Dropdown",
                "value": "dropdown"
              },
              {
                "label": "Radio",
                "value": "radio"
              }
            ]
          },
          {
            "type": "textarea",
            "id": "multiple_options",
            "label": "Options",
            "default": "Option 1\nOption 2\nOption 3",
            "info": "One option on each line"
          }
        ]
      },
      {
        "type": "custom_liquid",
        "name": "Custom Liquid",
        "settings": [
          {
            "type": "liquid",
            "id": "custom_liquid",
            "label": "Custom Liquid"
          },
          {
            "type": "checkbox",
            "id": "show_in_quickbuy",
            "label": "Show in quick buy",
            "default": false
          }
        ]
      },
      {
        "type": "related_products",
        "name": "Product list",
        "settings": [
          {
            "type": "paragraph",
            "content": "To use a different list for each product, use a product reference list [metafield](https:\/\/help.shopify.com\/en\/manual\/metafields) as a dynamic source."
          },
          {
            "type": "text",
            "id": "title",
            "label": "Heading",
            "info": "Only shows if products are present",
            "default": "Product list"
          },
          {
            "type": "product_list",
            "id": "product_list",
            "label": "Products"
          }
        ]
      },
      {
        "type": "complementary",
        "name": "Complementary products",
        "limit": 1,
        "settings": [
          {
            "type": "paragraph",
            "content": "To select complementary products, add the Search & Discovery app. [Learn more](https:\/\/shopify.dev\/themes\/product-merchandising\/recommendations)"
          },
          {
            "type": "text",
            "id": "block_heading",
            "default": "Pairs well with",
            "label": "Heading"
          },
          {
            "type": "checkbox",
            "id": "enable_carousel",
            "label": "Enable carousel",
            "default": true
          },
          {
            "type": "range",
            "id": "max_products",
            "min": 1,
            "max": 10,
            "step": 1,
            "label": "Maximum products to show",
            "default": 10
          }
        ]
      },
      {
        "type": "sharing",
        "name": "Sharing",
        "settings": [],
        "limit": 1
      },
      {
        "type": "divider",
        "name": "Divider",
        "settings": [
          {
            "type": "checkbox",
            "id": "show_in_quickbuy",
            "label": "Show in quick buy",
            "default": false
          }
        ]
      }
    ]
  }
{% endschema %}
